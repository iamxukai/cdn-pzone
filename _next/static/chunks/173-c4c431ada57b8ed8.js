(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[173],{74286:function(e,n,t){"use strict";t.d(n,{k:function(){return l},x:function(){return s}});var r=t(34051),i=t.n(r),a=t(21999);function o(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function c(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function c(e){o(a,r,i,c,l,"next",e)}function l(e){o(a,r,i,c,l,"throw",e)}c(void 0)}))}}var l=function(){var e=c(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.x.post("auth/logout",{}).catch(console.error);case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=c(i().mark((function e(n){var t,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.password,r=n.phone,e.next=3,a.x.post("auth/login",{phone:r,password:t}).catch((function(e){return e}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()},71988:function(e,n,t){"use strict";t.d(n,{T:function(){return o}});var r=t(85893),i=t(86674),a=t.n(i),o=function(e){var n=e.logoColor;return(0,r.jsx)("img",{src:"black"===n?"/pzone-black.png":"/pzone-white.png",alt:"logo",className:a().logo})}},47287:function(e,n,t){"use strict";t.d(n,{D:function(){return c}});var r=t(85893),i=t(97937),a=t(42898),o=t(71577),c=(t(67294),function(e){var n=e.show,t=e.setShowUnimplementedModal,c=function(){t(!1)};return(0,r.jsxs)(a.Z,{title:"\u77ed\u4fe1\u767b\u5f55\u548c\u5fd8\u8bb0\u5bc6\u7801\u529f\u80fd\u672a\u5b9e\u73b0",visible:n,onCancel:c,width:"350px",className:"modal-container",centered:!0,closable:!1,footer:[(0,r.jsx)(o.Z,{type:"primary",onClick:function(){return c()},className:"button",children:"\u786e\u8ba4"},"confirm")],destroyOnClose:!0,children:[(0,r.jsx)(i.Z,{className:"close-button",onClick:c}),"\u77ed\u4fe1\u767b\u5f55\u548c\u5fd8\u8bb0\u5bc6\u7801\u529f\u80fd\u9700\u8981\u7f51\u7ad9\u5907\u6848\uff0c\u6ca1\u6709\u5b9e\u73b0\u8fd9\u4e24\u529f\u80fd\u3002"]})})},24173:function(e,n,t){"use strict";t.d(n,{Z:function(){return Br}});var r,i=t(34051),a=t.n(i),o=t(85893),c=t(1634),l=t.n(c),s=t(11163),u=t(95591),d=t(32319),f=t(26911),p=t(45699),m=t(42365),v=t(97680),h=t(48689),x=t(41664),k=t(20809),w=t.n(k);!function(e){e.ALL_FILES="\u5168\u90e8\u6587\u4ef6",e.DOCUMENT="\u6587\u6863",e.IMAGE="\u56fe\u7247",e.MUSIC="\u97f3\u4e50",e.VIDEO="\u89c6\u9891",e.TRASH="\u56de\u6536\u7ad9"}(r||(r={}));var y=function(e){var n=e.asPath;return(0,o.jsx)("div",{className:w()["menu-container"],children:(0,o.jsxs)("ul",{children:[(0,o.jsxs)("li",{className:"/"===n?w()["item-active"]:void 0,children:["/"===n||(null===n||void 0===n?void 0:n.includes("folder"))?(0,o.jsx)(u.Z,{className:w().icon}):(0,o.jsx)(d.Z,{className:w().icon}),"/"===n||(null===n||void 0===n?void 0:n.includes("folder"))?(0,o.jsx)("a",{className:w().a,children:r.ALL_FILES}):(0,o.jsx)(x.default,{href:"/",children:(0,o.jsx)("a",{className:w().a,children:r.ALL_FILES})})]},"0"),(0,o.jsxs)("li",{className:"/document"===n?w()["item-active"]:void 0,children:[(0,o.jsx)(f.Z,{className:w().icon}),(0,o.jsx)(x.default,{href:"/document",children:(0,o.jsx)("a",{className:w().a,children:r.DOCUMENT})})]},"1"),(0,o.jsxs)("li",{className:"/image"===n?w()["item-active"]:void 0,children:[(0,o.jsx)(p.Z,{className:w().icon}),(0,o.jsx)(x.default,{href:"/image",children:(0,o.jsx)("a",{className:w().a,children:r.IMAGE})})]},"2"),(0,o.jsxs)("li",{className:"/music"===n?w()["item-active"]:void 0,children:[(0,o.jsx)(m.Z,{className:w().icon}),(0,o.jsx)(x.default,{href:"/music",children:(0,o.jsx)("a",{className:w().a,children:r.MUSIC})})]},"3"),(0,o.jsxs)("li",{className:"/video"===n?w()["item-active"]:void 0,children:[(0,o.jsx)(v.Z,{className:w().icon}),(0,o.jsx)(x.default,{href:"/video",children:(0,o.jsx)("a",{className:w().a,children:r.VIDEO})})]},"4"),(0,o.jsxs)("li",{className:"/trash"===n?w()["item-active"]:void 0,children:[(0,o.jsx)(h.Z,{className:w().icon}),(0,o.jsx)(x.default,{href:"/trash",children:(0,o.jsx)("a",{className:w().a,children:r.TRASH})})]},"5")]})})},g=t(71988),b=t(87505),j=t(67294),C=t(57459),_=t.n(C),N=function(e){var n=e.avatar,t=e.openAvatarEditModal,r=(0,j.useCallback)((function(){t(!0)}),[]);return(0,o.jsx)("div",{children:(0,o.jsx)("div",{className:_()["avatar-container"],children:n?(0,o.jsx)(b.C,{src:(0,o.jsx)("img",{src:n,alt:"avatar",onClick:r})}):(0,o.jsx)("div",{style:{width:"32px",height:"32px"}})})})},F=t(33189),I=t.n(F),S=function(e){var n=e.iconSrc;return(0,o.jsx)("img",{src:n,alt:"icon",className:I().icon})},A=t(98022),O=t(93045),M=t(87547),P=t(58638),E=t(42952),Z=t(16536),R=t(63859),L=t(13013),D=t(76484),T=t.n(D),U=t(74286);function B(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var W=function(e){var n,t=e.openUserInfoEditModal,r=e.openPasswordEditModal,i=(0,s.useRouter)(),c={content:"hello, pzone",duration:3,icon:(0,o.jsx)(O.Z,{}),type:"info"},l=(0,j.useCallback)((function(){Z.ZP.open(c)}),[]),u=(0,j.useCallback)((n=a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,U.k)();case 2:(0,A.gy)(),i.replace("/login");case 4:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){B(a,r,i,o,c,"next",e)}function c(e){B(a,r,i,o,c,"throw",e)}o(void 0)}))}),[]),d=(0,o.jsxs)(R.Z,{children:[(0,o.jsx)(R.Z.Item,{icon:(0,o.jsx)(M.Z,{}),onClick:t,children:"\u4fee\u6539\u4e2a\u4eba\u4fe1\u606f"},"1"),(0,o.jsx)(R.Z.Item,{icon:(0,o.jsx)(S,{iconSrc:"security.png"}),onClick:r,children:"\u4fee\u6539\u5bc6\u7801"},"2"),(0,o.jsx)(R.Z.Item,{icon:(0,o.jsx)(S,{iconSrc:"favicon.ico"}),onClick:l,children:"\u5173\u4e8ePZone"},"3"),(0,o.jsx)(R.Z.Item,{icon:(0,o.jsx)(P.Z,{}),onClick:u,children:"\u9000\u51fa\u767b\u5f55"},"4")]});return(0,o.jsx)(L.Z,{overlay:d,placement:"top",arrow:!0,children:(0,o.jsx)(E.Z,{className:T().icon})})},z=t(3206),V=t.n(z),H=t(27049),K=t(8507),$=["potm","potx","ppam","pps","ppsm","ppsx","ppt","pptm","pptx"],Y=["doc","docm","docx","dot","dotx"],J=["md","markdown"],q=["xla","xlam","xll","xlm","xlsm","xls","xlsx","xlt","xltm","xltx"],G=["zip","rar","jar","cab","arj","lzh","ace","7-zip","tar","gzip","z","iso","bz2","uue"],Q=["jpg","jpeg","gif","png","psd","bmp","emf","swf","svg","ico","webp","xbm","tif","pjp","svgz","tiff","jfif","avif","raw"],X=["midi","mp3","wma","wave","rm","wav","aif","aiff","au","ra","rm","ram","mid","rmi","pcm","flac","alac","ogg","aac"],ee=["avi","wmv","mpeg","dv","rm","rmvb","mov","mp4","m4v","flv","asf","asx","3gp","dat","vob","mkv","mpg","webm"],ne=function(e,n,t){if(n&&n===K.Tv.folder)return K.LV.folder;var r=e.split(".").slice(-1)[0].toLowerCase();if(-1!==Y.indexOf(r))return K.LV.word;if(-1!==J.indexOf(r))return K.LV.markdown;if(-1!==$.indexOf(r))return K.LV.ppt;if(-1!==q.indexOf(r))return K.LV.excel;if("pdf"===r)return K.LV.pdf;if("txt"===r)return K.LV.txt;if(-1!==G.indexOf(r))return K.LV.zip;if(-1!==Q.indexOf(r))return K.LV.image;if(-1!==X.indexOf(r))return K.LV.music;if(-1!==ee.indexOf(r))return K.LV.video;if(!t)return K.LV.white;switch(t.toString().split("/")[0].toLocaleLowerCase()){case"text":return K.LV.txt;case"application":default:return K.LV.white;case"image":return K.LV.image;case"audio":return K.LV.music;case"video":return K.LV.video}},te=function(e){if(void 0===e||null===e)return"";if(e<=1024)return e+" B";if((e/=1024)<=1024){var n=Math.round(e);return(n===e?n:e.toFixed(2))+" KB"}if((e/=1024)<=1024){var t=Math.round(e);return(t===e?t:e.toFixed(2))+" MB"}if((e/=1024)<=1024){var r=Math.round(e);return(r===e?r:e.toFixed(2))+" GB"}if((e/=1024)<=1024){var i=Math.round(e);return(i===e?i:e.toFixed(2))+" TB"}return""},re=function(e){if(!e)return"";if(e.type===K.Tv.folder)return"";var n,t=e.originalname;return-1===t.indexOf(".")?"":null!==(n=t.split(".").pop())&&void 0!==n?n:""},ie=function(e){if(!e)return"";var n=e.originalname;if(e.type===K.Tv.folder)return n;var t=re(e);if(""===t)return n;var r=n.lastIndexOf(t);return n.slice(0,r-1)},ae=function(e){var n=e.folderName,t={fieldname:"file",originalname:n,size:0,mimetype:"",encoding:"",buffer:""},r=new Blob([JSON.stringify(t)],{type:"application/json"});return{file:new File([r],n),type:K.Tv.folder}},oe=t(82670),ce=t(69368),le=t.n(ce),se=function(e){var n=e.total,t=e.used;return(0,o.jsxs)("div",{className:le()["progress-container"],children:[(0,o.jsxs)("span",{className:le().text,children:[te(t)," / ",te(n)]}),(0,o.jsx)(oe.Z,{percent:function(e,n){var t=e/n*100,r=Math.round(t);return r===t?r:parseFloat(t.toFixed(1))}(t,n),status:"active",trailColor:"#e2e2e2",showInfo:!1})]})},ue=t(97937),de=t(52745),fe=t(24969),pe=t(43749),me=t(56424),ve=t(21999);function he(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function xe(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){he(a,r,i,o,c,"next",e)}function c(e){he(a,r,i,o,c,"throw",e)}o(void 0)}))}}var ke=function(){var e=xe(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("users/capacity",{}).catch((function(e){return e}));case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),we=function(){var e=xe(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.get("users",{}).catch(console.error);case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ye=function(){var e=xe(a().mark((function e(n){var t,r,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.avatar,r=n.name,i=n.bio,o=new FormData,t&&o.append("avatar",t),r&&o.append("name",r),i&&o.append("bio",i),e.next=7,ve.x.post("users/update",o).catch(console.error);case 7:return c=e.sent,e.abrupt("return",null===c||void 0===c?void 0:c.data);case 9:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),ge=function(){var e=xe(a().mark((function e(n){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.oldPassword,r=n.newPassword,e.abrupt("return",ve.x.post("users/password",{oldPassword:t,newPassword:r}).catch((function(e){return e})));case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),be=t(42898),je=t(71577),Ce=t(22918),_e=t(27011),Ne=t.n(_e),Fe=t(89391),Ie=t.n(Fe);function Se(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var Ae=function(e){var n=e.avatarSrc,t=e.show,r=e.setShowAvatarEditModal,i=e.updateUserInfoState,c=(0,j.useState)(""),l=c[0],s=c[1],u=(0,j.useState)(n),d=u[0],f=u[1],p=(0,j.useState)(!1),m=p[0],v=p[1],h=(0,j.useState)(1),x=h[0],k=h[1],w=(0,j.useState)(0),y=w[0],g=w[1],b=(0,j.useRef)(null),C=(0,j.useRef)(null),_=function(){var e,n=(e=a().mark((function e(){var n,t,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v(!0),!b.current){e.next=12;break}return n=b.current.getImageScaledToCanvas().toDataURL(),e.next=5,fetch(n).then((function(e){return e.blob()}));case 5:return t=e.sent,o=new File([t],"avatar"),e.next=9,ye({avatar:o});case 9:i(),v(!1),r(!1);case 12:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Se(a,r,i,o,c,"next",e)}function c(e){Se(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),N=function(){r(!1)},F=(0,j.useCallback)((function(){b.current&&s(b.current.getImageScaledToCanvas().toDataURL())}),[b]),I=(0,j.useCallback)((function(){g((y-90)%360)}),[y]),S=(0,j.useCallback)((function(){g((y+90)%360)}),[y]),A=(0,j.useCallback)((function(){var e;null===(e=C.current)||void 0===e||e.click()}),[C]),O=(0,j.useCallback)((function(e){var n=e.target.files[0];f(n),e.target.value=""}),[]),M=(0,j.useCallback)((function(e){k(e)}),[]),P=(0,j.useCallback)((function(){k(x+.2>=2?2:x+.2)}),[x]),E=(0,j.useCallback)((function(){k(x-.2<=1?1:x-.2)}),[x]);return(0,j.useEffect)((function(){t&&(g(0),k(1),s(""),f(n))}),[t]),(0,o.jsxs)(be.Z,{title:"\u66f4\u6362\u5934\u50cf",visible:t,onOk:_,onCancel:N,centered:!0,width:"480px",className:"modal-container",closable:!1,destroyOnClose:!0,footer:[(0,o.jsx)(je.Z,{type:"ghost",onClick:N,className:"button",children:"\u53d6\u6d88"},"cancel"),(0,o.jsx)(je.Z,{type:"primary",onClick:_,loading:m,className:"button",children:"\u786e\u8ba4"},"submit")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:N}),(0,o.jsxs)("div",{className:Ie()["modal-body"],children:[(0,o.jsxs)("div",{className:Ie()["edit-section"],children:[(0,o.jsx)(Ne(),{width:250,height:250,border:0,borderRadius:125,image:d,ref:b,scale:x,rotate:y,onPositionChange:F,onImageReady:F,onImageChange:F,onMouseMove:F,onMouseUp:F,crossOrigin:"anonymous"}),(0,o.jsxs)("div",{className:Ie().actions,children:[(0,o.jsxs)("div",{className:Ie()["scale-action"],children:[(0,o.jsx)(de.Z,{className:"".concat(Ie().icon," icon"),onClick:E}),(0,o.jsx)(Ce.Z,{min:1,max:2,step:.01,defaultValue:1,value:x,tooltipVisible:!1,className:"".concat(Ie().slider," slider"),onChange:function(e){return M(e)}}),(0,o.jsx)(fe.Z,{className:"".concat(Ie().icon," icon"),onClick:P})]}),(0,o.jsx)(pe.Z,{className:"".concat(Ie().icon," icon"),onClick:I}),(0,o.jsx)(me.Z,{className:"".concat(Ie().icon," icon"),onClick:S})]})]}),(0,o.jsxs)(je.Z,{className:"button ".concat(Ie()["upload-button"]),onClick:A,children:[(0,o.jsx)("input",{type:"file",accept:"image/png, image/jpeg, image/jpg",hidden:!0,ref:C,onChange:function(e){return O(e)}}),"\u6311\u9009\u672c\u5730\u56fe\u7247"]}),(0,o.jsxs)("div",{className:Ie()["preview-section"],children:[(0,o.jsx)("p",{children:"\u5934\u50cf\u9884\u89c8"}),l&&(0,o.jsx)("img",{src:l,alt:"Preview",width:"100px",height:"100px"})]})]})]})},Oe=t(19197),Me=t(50519),Pe=t.n(Me);function Ee(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var Ze=function(e){var n=e.show,t=e.avatarSrc,r=e.name,i=e.bio,c=e.setShowUserInfoEditModal,l=e.openAvatarEditModal,s=e.updateUserInfoState,u=(0,j.useState)(!1),d=u[0],f=u[1],p=(0,j.useState)(r),m=p[0],v=p[1],h=(0,j.useState)(i),x=h[0],k=h[1],w=Oe.Z.TextArea,y=(0,j.useCallback)((function(e){v(e.target.value)}),[]),g=(0,j.useCallback)((function(e){k(e.target.value)}),[]),C=function(){var e,n=(e=a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),e.next=3,ye({name:m,bio:x});case 3:s(),f(!1),c(!1);case 6:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Ee(a,r,i,o,c,"next",e)}function c(e){Ee(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),_=function(){c(!1)};return(0,j.useEffect)((function(){n&&(k(i),v(r))}),[n]),(0,o.jsxs)(be.Z,{title:"\u8d44\u6599\u7f16\u8f91",visible:n,onOk:C,onCancel:_,centered:!0,width:"400px",className:"modal-container",closable:!1,destroyOnClose:!0,footer:[(0,o.jsx)(je.Z,{type:"ghost",onClick:_,className:"button",children:"\u53d6\u6d88"},"cancel"),(0,o.jsx)(je.Z,{type:"primary",onClick:C,loading:d,className:"button",disabled:!m,children:"\u786e\u8ba4"},"submit")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:_}),(0,o.jsxs)("div",{className:Pe()["modal-body"],children:[(0,o.jsxs)("div",{className:Pe()["input-group"],children:[(0,o.jsxs)("div",{className:Pe()["group-item"],children:[(0,o.jsx)("label",{children:"\u6635\u79f0"}),(0,o.jsx)(Oe.Z,{placeholder:"\u7528\u6237\u6635\u79f0",onPressEnter:C,className:"".concat(Pe().input," input"),value:m,onChange:y})]}),(0,o.jsxs)("div",{className:Pe()["group-item"],children:[(0,o.jsx)("label",{children:"\u7b80\u4ecb"}),(0,o.jsx)(w,{value:x,rows:3,maxLength:30,placeholder:"\u4e2a\u4eba\u7b80\u4ecb\uff0c\u5b57\u6570\u4e0d\u8d85\u8fc730",onPressEnter:C,className:"input",style:{resize:"none"},onChange:g})]})]}),(0,o.jsxs)("div",{className:Pe()["right-section"],children:[(0,o.jsx)("p",{children:"\u7528\u6237\u5934\u50cf"}),(0,o.jsxs)("div",{className:Pe()["avatar-container"],children:[(0,o.jsx)(b.C,{src:t,className:Pe().avatar}),(0,o.jsx)("div",{className:Pe()["avatar-mask"],onClick:l,children:"\u66f4\u6362\u5934\u50cf"})]})]})]})]})},Re=t(84758),Le=t(73294),De=t.n(Le);function Te(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var Ue=function(e){var n=e.show,t=e.setShowPasswordEditModal,r=e.openUnimplementedModal,i=(0,j.useState)(""),c=i[0],l=i[1],s=(0,j.useState)(""),u=s[0],d=s[1],f=function(){var e,n=(e=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ge({oldPassword:Re.V.hashStr(c),newPassword:Re.V.hashStr(u)});case 2:204!==(n=e.sent).status&&"PhoneOrPasswordWrong"===n.response.data.code&&Z.ZP.error("\u5f53\u524d\u5bc6\u7801\u9519\u8bef"),204===n.status&&t(!1);case 5:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Te(a,r,i,o,c,"next",e)}function c(e){Te(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),p=function(){t(!1)},m=(0,j.useCallback)((function(e){l(e.target.value)}),[]),v=(0,j.useCallback)((function(e){d(e.target.value)}),[]);return(0,j.useEffect)((function(){n&&(l(""),d(""))}),[n]),(0,o.jsxs)(be.Z,{title:"\u4fee\u6539\u5bc6\u7801",visible:n,onOk:f,onCancel:p,centered:!0,width:"320px",className:"modal-container",closable:!1,destroyOnClose:!0,footer:[(0,o.jsx)(je.Z,{type:"ghost",onClick:p,className:"button",children:"\u53d6\u6d88"},"cancel"),(0,o.jsx)(je.Z,{type:"primary",onClick:f,className:"button",disabled:!c||!u,children:"\u786e\u8ba4"},"submit")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:p}),(0,o.jsxs)("div",{className:De()["modal-body"],children:[(0,o.jsxs)("div",{className:De()["input-item"],children:[(0,o.jsx)("label",{children:"\u5f53\u524d\u5bc6\u7801"}),(0,o.jsx)(Oe.Z.Password,{onPressEnter:f,className:"".concat(De().input," input"),value:c,onChange:m})]}),(0,o.jsxs)("div",{className:De()["input-item"],children:[(0,o.jsx)("label",{children:"\u65b0\u7684\u5bc6\u7801"}),(0,o.jsx)(Oe.Z.Password,{onPressEnter:f,className:"".concat(De().input," input"),value:u,onChange:v})]}),(0,o.jsx)("a",{onClick:r,children:"\u5fd8\u8bb0\u5bc6\u7801"})]})]})},Be=t(47287);function We(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function ze(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){We(a,r,i,o,c,"next",e)}function c(e){We(a,r,i,o,c,"throw",e)}o(void 0)}))}}var Ve=function(e){var n=e.asPath,t=e.logoColor,r=e.usedSize,i=e.totalSize,c=(0,j.useState)(""),l=c[0],s=c[1],u=(0,j.useState)(""),d=u[0],f=u[1],p=(0,j.useState)(""),m=p[0],v=p[1],h=(0,j.useState)(!1),x=h[0],k=h[1],w=(0,j.useState)(!1),b=w[0],C=w[1],_=(0,j.useState)(!1),F=_[0],I=_[1],S=(0,j.useState)(!1),A=S[0],O=S[1],M=(0,j.useCallback)(ze(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we();case 2:n=e.sent,s(n.name),n.avatar&&f(n.avatar),v(n.bio);case 6:case"end":return e.stop()}}),e)}))),[we]);return(0,j.useEffect)((function(){ze(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we();case 2:(n=e.sent)&&s(n.name),n&&n.avatar?f(n.avatar):f("default-avatar.png"),n&&v(n.bio);case 6:case"end":return e.stop()}}),e)})))()}),[we]),(0,o.jsxs)("div",{className:V()["sidebar-container"],children:[(0,o.jsx)("div",{className:V()["top-container"],children:(0,o.jsx)(g.T,{logoColor:t})}),(0,o.jsx)("div",{className:V()["nav-container"],children:(0,o.jsx)(y,{asPath:n})}),(0,o.jsx)(se,{used:r,total:i}),(0,o.jsx)(H.Z,{className:V().divider}),(0,o.jsxs)("div",{className:V()["bottom-container"],children:[(0,o.jsxs)("div",{className:V()["user-info"],children:[(0,o.jsx)(N,{avatar:d,openAvatarEditModal:k}),(0,o.jsx)("span",{children:l})]}),(0,o.jsx)(W,{openUserInfoEditModal:function(){return C(!0)},openPasswordEditModal:function(){return I(!0)}})]}),(0,o.jsx)(Ae,{avatarSrc:d,show:x,setShowAvatarEditModal:k,updateUserInfoState:M}),(0,o.jsx)(Ze,{show:b,setShowUserInfoEditModal:C,openAvatarEditModal:function(){return k(!0)},updateUserInfoState:M,avatarSrc:d,name:l,bio:m}),(0,o.jsx)(Ue,{show:F,setShowPasswordEditModal:I,openUnimplementedModal:function(){return O(!0)}}),(0,o.jsx)(Be.D,{show:A,setShowUnimplementedModal:O})]})},He=t(65837),Ke=t.n(He);function $e(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function Ye(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){$e(a,r,i,o,c,"next",e)}function c(e){$e(a,r,i,o,c,"throw",e)}o(void 0)}))}}var Je=function(){var e=Ye(a().mark((function e(n){var t,r,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.fileId,r=n.fileCategory,i=n.needDownload,e.next=3,ve.x.post("files/find",{fileId:t,videoPreview:r&&r===K.Wi.Video,needUrl:!0,needDownload:i}).catch(console.error);case 3:return o=e.sent,e.abrupt("return",null===o||void 0===o?void 0:o.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),qe=function(){var e=Ye(a().mark((function e(n,t){var r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=fetch(n,{method:"GET",mode:"cors",headers:{Authorization:"Bearer ".concat((0,A.hP)())}}).then(function(){var e=Ye(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&t===K.LV.txt||t===K.LV.markdown)){e.next=4;break}return e.next=3,n.text();case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()).catch(console.error),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),Ge=function(){var e=Ye(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement("iframe")).style.display="none",t.style.height="0",t.src=n,document.body.appendChild(t),setTimeout((function(){t.remove()}),12e4);case 6:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Qe=function(){var e=Ye(a().mark((function e(n){var t,r,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.fileId,r=n.newName,i=n.parentFileId,e.next=3,ve.x.post("files/update",{fileId:t,newName:r,parentFileId:i}).catch(console.error);case 3:return o=e.sent,e.abrupt("return",null===o||void 0===o?void 0:o.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),Xe=function(){var e=Ye(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/trash",{fileIdList:n}).catch(console.error);case 2:return t=e.sent,e.abrupt("return",null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),en=function(){var e=Ye(a().mark((function e(n){var t,r,i,o,c,l,s;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.parentFileId,r=n.orderBy,i=n.orderDirection,o=n.fileCategory,c=n.originalname,l=n.trashed,e.next=3,ve.x.post("files/find",{parentFileId:t,orderBy:r,orderDirection:i,fileCategory:o,originalname:c,trashed:l}).catch(console.error);case 3:return s=e.sent,e.abrupt("return",null===s||void 0===s?void 0:s.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),nn=function(){var e=Ye(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/delete",{fileIdList:n}).catch(console.error);case 2:return t=e.sent,e.abrupt("return",null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),tn=function(){var e=Ye(a().mark((function e(n){var t,r,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.fileId,r=n.sameNameMode,i=n.newParentFileId,e.next=3,ve.x.post("files/position",{fileId:t,sameNameMode:r,newParentFileId:i}).catch(console.error);case 3:return o=e.sent,e.abrupt("return",null===o||void 0===o?void 0:o.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),rn=(function(){var e=Ye(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/path",{fileId:n}).catch(console.error);case 2:return t=e.sent,e.abrupt("return",null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})))}(),function(){var e=Ye(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/size",{fileId:n}).catch(console.error);case 2:return t=e.sent,e.abrupt("return",null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),an=function(){var e=Ye(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/clear",{}).catch((function(e){return e}));case 2:return n=e.sent,e.abrupt("return",null===n||void 0===n?void 0:n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),on=t(39920);function cn(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ln(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){cn(e,n,t[n])}))}return e}var sn=function(e){var n=e.length,t=e.options,r=e.setItemContainerProps,i=void 0===r?function(){return{}}:r,a=e.renderItem,c=(0,on.useTrail)(n,ln({config:{mass:2,tension:280,friction:24,clamp:!0}},t));return(0,o.jsx)(o.Fragment,{children:c.map((function(e,n){return(0,o.jsx)(on.animated.div,ln({style:e},i(n),{children:a(n)}),n)}))})},un=t(27484),dn=t.n(un),fn=t(7124),pn=t.n(fn),mn=(t(33852),t(10285)),vn=t.n(mn),hn=t(50356),xn=t.n(hn),kn=function(e){if(!e)return"";dn().extend(pn()),dn().extend(xn()),dn().extend(vn()),dn().locale("zh-cn");var n=dn()(e);return n.isYesterday()?"\u6628\u5929"+n.format("H:mm"):n.isToday()?"\u4eca\u5929"+n.format("H:mm"):n.format("YYYY/MM/DD H:mm")},wn=t(87782),yn=t(26062),gn=t(92040),bn=t.n(gn),jn=function(e){var n=e.fileIcon,t=e.size;return t&&"small"===t?(0,o.jsx)("div",{className:bn()["file-icon-container"],children:(0,o.jsx)("img",{draggable:!1,height:"30px",width:"30px",src:n?"/file-icon/".concat(n):"/file-icon/white.png"})}):(0,o.jsx)("div",{className:bn()["file-icon-container"],children:(0,o.jsx)("img",{draggable:!1,height:"80px",width:"80px",src:n?"/file-icon/".concat(n):"/file-icon/white.png"})})},Cn=t(87339),_n=t.n(Cn),Nn=(t(6614),function(e){var n=e.file,t=e.showMoreMenu,r=e.onDownloadItemClick,i=e.onConfirmTrashItemClick,a=e.onRenameFileItemClick,c=e.onDetailFileItemClick,l=e.onOpenFileMoveItemClick,s=e.onDeleteItemClick,u=e.onRestoreItemClick,d=(0,j.useState)(!1),f=d[0],p=d[1],m=(0,j.useCallback)((function(e){f?i&&i(n.fileId):e.stopPropagation(),p(!f)}),[f]),v=(0,j.useCallback)((function(){p(!1)}),[]);return(0,o.jsxs)(yn.v2,{animation:{enter:yn.oQ.scale,exit:!1},id:n.fileId,className:"context-menu",onHidden:v,children:[r&&(0,o.jsx)(yn.ck,{onClick:function(){return r(n)},children:"\u4e0b\u8f7d"},"1"),t&&a&&(0,o.jsx)(yn.ck,{onClick:function(){return a(n)},children:"\u91cd\u547d\u540d"},"2"),t&&l&&(0,o.jsx)(yn.ck,{onClick:function(){return l(n)},children:"\u79fb\u52a8"},"3"),t&&c&&(0,o.jsx)(yn.ck,{onClick:function(){return c(n)},children:"\u67e5\u770b\u8be6\u7ec6\u4fe1\u606f"},"4"),i&&(0,o.jsxs)(yn.ck,{className:"dangerours-item",onClick:function(e){var n=e.event;return m(n)},children:[!f&&"\u79fb\u81f3\u56de\u6536\u7ad9",f&&"\u786e\u8ba4\u79fb\u9664\u5417"]},"5"),u&&(0,o.jsx)(yn.ck,{onClick:function(){return u(n)},children:"\u8fd8\u539f"},"6"),s&&(0,o.jsx)(yn.ck,{className:"dangerours-item",onClick:function(){return s(n.fileId)},children:"\u5f7b\u5e95\u5220\u9664"},"7")]})});function Fn(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function In(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Fn(a,r,i,o,c,"next",e)}function c(e){Fn(a,r,i,o,c,"throw",e)}o(void 0)}))}}var Sn=function(e){var n=e.file,t=e.detailMode,r=e.keywords,i=e.onlyFolderClick,c=e.fileCategory,l=e.onOpenRenameModal,s=e.onOpenDetailFileModal,u=e.onFileClick,d=e.onFileCheckButtonClick,f=e.onAllCheckedFilesDownload,p=e.onAllCheckedFilesTrashed,m=e.onOpenFileMoveModal,v=e.onOpenFilesDeleteModal,h=e.onAllCheckedFilesRestore,x=e.checkNum,k=(0,j.useState)(!0),w=k[0],y=k[1],g=(0,j.useState)(),b=g[0],C=g[1],_=kn(n.updatedAt),N=(0,yn.av)(),F=N.show,I=N.hideAll;function S(){return(S=In(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f&&f(n);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=In(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:p&&p(n);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var O=(0,j.useCallback)((function(e){I(),F(e,{id:n.fileId}),e.stopPropagation()}),[n.fileId]),M=(0,j.useCallback)((function(e){I(),v&&v(e)}),[]);return(0,j.useEffect)((function(){x&&x>1&&!0===n.checked?y(!1):y(!0)}),[x]),(0,j.useEffect)((function(){if(r){var e=function(e,n){if(1!==n.length)return{highlightPieceBefore:e};var t=n[0],r=e.indexOf(t);return-1===r?{highlightPieceBefore:e}:{highlightPieceBefore:e.slice(0,r),highlightPiece:e.slice(r,r+t.length),highlightPieceAfter:e.slice(r+t.length)}}(n.originalname,r);C(e)}}),[r,n.originalname]),(0,o.jsxs)("div",{className:_n()["tr-container"],children:[d&&(0,o.jsx)(wn.Z,{className:"checkbox-container ".concat(_n()["select-button"]," ").concat(n.checked?_n()["button-show"]:_n()["button-hidden"]),onClick:function(){return d(n.fileId)},checked:n.checked}),(0,o.jsxs)("div",{className:"".concat(_n()["file-container"]," ").concat(i&&n.fileCategory!==K.Wi.Folder&&_n()["not-click-allowed"]),onClick:function(){return u&&u(n.fileId,n.fileCategory,n.originalname)},onContextMenu:O,children:[d&&(0,o.jsx)("div",{style:{width:"31px"}}),(0,o.jsxs)("div",{className:_n()["icon-filename-container"],children:[(0,o.jsx)(jn,{fileIcon:ne(n.originalname,n.type,n.mimetype)+".png",size:"small"}),r&&(0,o.jsxs)("div",{className:_n().filename,children:[(null===b||void 0===b?void 0:b.highlightPieceBefore)&&(0,o.jsx)("span",{children:b.highlightPieceBefore}),(null===b||void 0===b?void 0:b.highlightPiece)&&(0,o.jsx)("span",{className:_n().hignlight,children:b.highlightPiece}),(null===b||void 0===b?void 0:b.highlightPieceAfter)&&(0,o.jsx)("span",{children:b.highlightPieceAfter})]}),!r&&(0,o.jsx)("span",{className:_n().filename,children:n.originalname})]}),t&&(0,o.jsx)("span",{className:_n()["sort-by-time"],children:_}),t&&(0,o.jsx)("span",{className:_n().size,children:n.fileCategory!==K.Wi.Folder&&te(n.size)})]}),l&&s&&(0,o.jsx)(Nn,{file:n,showMoreMenu:w,onDownloadItemClick:c!==K.Wi.TRASH?function(e){return S.apply(this,arguments)}:void 0,onRenameFileItemClick:c!==K.Wi.TRASH?l:void 0,onDetailFileItemClick:c!==K.Wi.TRASH?s:void 0,onConfirmTrashItemClick:c!==K.Wi.TRASH?function(e){return A.apply(this,arguments)}:void 0,onOpenFileMoveItemClick:c!==K.Wi.TRASH?m:void 0,onRestoreItemClick:c===K.Wi.TRASH?h:void 0,onDeleteItemClick:c===K.Wi.TRASH?M:void 0})]})};function An(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}Sn.defaultProps={detailMode:!0,onlyFolderClick:!1};var On=function(e){var n=e.show,t=e.orderBy,r=e.orderDirection,i=e.fileCategory,c=e.setShowFileSearchModal,l=e.onFileClick,s=(0,j.useState)([]),u=s[0],d=s[1],f=(0,j.useState)(""),p=f[0],m=f[1],v=(0,j.useState)([]),h=v[0],x=v[1],k=(0,j.useState)(),w=k[0],y=k[1],g=function(){c(!1),d(null),m("")},b=(0,j.useCallback)((function(e){m(e.target.value)}),[]),C=(0,j.useCallback)((function(e,n,t){c(!1),d(null),m(""),l(e,n,t)}),[]);return(0,j.useEffect)((function(){var e=p.trim().split(" ");if(""===e[0])return clearTimeout(w),void d(null);x(e),clearTimeout(w);var n=window.setTimeout((function(){var e;(e=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en({orderBy:t,orderDirection:r,originalname:p,fileCategory:i});case 2:n=e.sent,d(n);case 4:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){An(a,r,i,o,c,"next",e)}function c(e){An(a,r,i,o,c,"throw",e)}o(void 0)}))})()}),600);y(n)}),[t,r,p,i]),(0,o.jsxs)(be.Z,{title:i===K.Wi.ALL?"\u5168\u7c7b\u522b\u641c\u7d22":i===K.Wi.Document?"\u6587\u6863\u641c\u7d22":i===K.Wi.Image?"\u56fe\u7247\u641c\u7d22":i===K.Wi.Music?"\u97f3\u4e50\u641c\u7d22":i===K.Wi.Video?"\u89c6\u9891\u641c\u7d22":"\u8d44\u6e90\u641c\u7d22",visible:n,onCancel:g,width:"550px",className:"modal-container",closable:!1,footer:null,destroyOnClose:!0,children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:g}),(0,o.jsxs)("div",{className:Ke()["modal-body"],children:[(0,o.jsx)(Oe.Z,{autoFocus:!0,value:p,onChange:b,className:"input"}),(0,o.jsx)("section",{className:Ke()["search-result"],children:u&&u.length?(0,o.jsx)(sn,{length:u.length,options:{config:{mass:1,tension:180,friction:12,clamp:!0},opacity:u.length?1:0,height:u.length?68:0,from:{opacity:0,height:0}},renderItem:function(e){var n=u[e];return(0,o.jsx)(Sn,{file:n,keywords:h,onFileClick:C,detailMode:!1,fileCategory:i})}}):u?(0,o.jsx)("p",{className:Ke().empty,children:"\u6ca1\u6709\u76f8\u5173\u6587\u4ef6"}):null})]})]})},Mn=t(33859),Pn=function(e){var n=e.fileCategory,t=e.parentFileId,r=e.onOpenNewFolderModalItemClick,i=e.onUploadFilesItemClick,a=e.onUploadFolderItemClick;return n===K.Wi.ALL?(0,o.jsx)("div",{className:"empty-container",children:(0,o.jsx)(Mn.ZP,{icon:(0,o.jsx)(O.Z,{}),title:"\u8fd9\u513f\u5565\u90fd\u6ca1\u6709",subTitle:"\u4f60\u53ef\u4ee5",extra:[(0,o.jsx)(je.Z,{type:"primary",onClick:function(){return r(t)},children:"\u521b\u5efa\u6587\u4ef6\u5939"},"new-folder"),(0,o.jsx)(je.Z,{onClick:i,children:"\u4e0a\u4f20\u6587\u4ef6"},"upload-file"),(0,o.jsx)(je.Z,{onClick:a,children:"\u4e0a\u4f20\u6587\u4ef6\u5939"},"upload-folder")]})}):(0,o.jsx)("div",{className:"empty-container",children:(0,o.jsx)(Mn.ZP,{icon:(0,o.jsx)(O.Z,{}),title:"\u8fd9\u513f\u5565\u90fd\u6ca1\u6709"})})},En=t(97751),Zn=t(32624),Rn=t.n(Zn);function Ln(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function Dn(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Ln(a,r,i,o,c,"next",e)}function c(e){Ln(a,r,i,o,c,"throw",e)}o(void 0)}))}}var Tn=function(e){var n=e.file,t=e.checkNum,r=e.fileCategory,i=e.onOpenRenameModal,c=e.onOpenDetailFileModal,l=e.onFileClick,s=e.onFileCheckButtonClick,u=e.onAllCheckedFilesDownload,d=e.onAllCheckedFilesTrashed,f=e.onOpenFileMoveModal,p=e.onOpenFilesDeleteModal,m=e.onAllCheckedFilesRestore,v=kn(n.updatedAt),h=(0,yn.av)(),x=h.show,k=h.hideAll,w=(0,j.useCallback)((function(e){x(e,{id:n.fileId}),e.stopPropagation()}),[n.fileId]);function y(){return(y=Dn(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u(n);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Dn(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(),d(n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var b=(0,j.useCallback)((function(e){k(),p(e)}),[]),C=(0,j.useState)(!0),_=C[0],N=C[1];return(0,j.useEffect)((function(){t>1&&!0===n.checked?N(!1):N(!0)}),[t]),(0,o.jsxs)("div",{className:Rn()["card-container"],children:[(0,o.jsx)(wn.Z,{className:"checkbox-container ".concat(Rn()["select-button"]," ").concat(n.checked?Rn()["button-show"]:Rn()["button-hidden"]),onClick:function(){return s(n.fileId)},checked:n.checked}),(0,o.jsxs)(En.Z,{hoverable:!0,className:Rn().card,cover:(0,o.jsx)(jn,{fileIcon:ne(n.originalname,n.type,n.mimetype)+".png"}),bodyStyle:{padding:"5px",textAlign:"center"},onClick:function(){return l&&l(n.fileId,n.fileCategory,n.originalname)},onContextMenu:w,children:[(0,o.jsx)("p",{className:Rn().filename,children:n.originalname}),(0,o.jsx)("p",{className:Rn()["update-time"],children:v})]}),(0,o.jsx)(Nn,{file:n,showMoreMenu:_,onDownloadItemClick:r!==K.Wi.TRASH?function(e){return y.apply(this,arguments)}:void 0,onRenameFileItemClick:r!==K.Wi.TRASH?i:void 0,onDetailFileItemClick:r!==K.Wi.TRASH?c:void 0,onConfirmTrashItemClick:r!==K.Wi.TRASH?function(e){return g.apply(this,arguments)}:void 0,onOpenFileMoveItemClick:r!==K.Wi.TRASH?f:void 0,onRestoreItemClick:r===K.Wi.TRASH?m:void 0,onDeleteItemClick:r===K.Wi.TRASH?b:void 0})]})},Un=t(38200),Bn=t.n(Un),Wn=function(e){var n=e.files,t=e.checkNum,r=e.fileCategory,i=e.parentFileId,a=e.onOpenRenameModal,c=e.onOpenDetailFileModal,l=e.onFileClick,s=e.onFileCheckButtonClick,u=e.onAllCheckedFilesDownload,d=e.onAllCheckedFilesTrashed,f=e.onOpenFileMoveModal,p=e.onOpenFilesDeleteModal,m=e.onAllCheckedFilesRestore,v=e.onOpenNewFolderModalItemClick,h=e.onUploadFilesItemClick,x=e.onUploadFolderItemClick,k=(0,yn.av)().hideAll;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:Bn()["grid-container"],onScroll:k,children:null===n||void 0===n?void 0:n.map((function(e){return(0,o.jsx)(Tn,{file:e,fileCategory:r,onFileClick:r!==K.Wi.TRASH?l:void 0,onFileCheckButtonClick:s,onAllCheckedFilesDownload:u,onAllCheckedFilesTrashed:d,onAllCheckedFilesRestore:m,checkNum:t,onOpenRenameModal:a,onOpenDetailFileModal:c,onOpenFileMoveModal:f,onOpenFilesDeleteModal:p},e.fileId)}))}),n&&0===n.length&&(0,o.jsx)(Pn,{fileCategory:r,onOpenNewFolderModalItemClick:v,parentFileId:i,onUploadFilesItemClick:h,onUploadFolderItemClick:x})]})},zn=t(76026),Vn=t.n(zn),Hn=t(77171),Kn=t(1912),$n=function(e){var n=e.files,t=e.checkNum,r=e.fileCategory,i=e.parentFileId,a=e.orderBy,c=e.orderDirection,l=e.onOpenRenameModal,s=e.onOpenDetailFileModal,u=e.onFileClick,d=e.onFileCheckButtonClick,f=e.onAllCheckedFilesDownload,p=e.onAllCheckedFilesTrashed,m=e.onOpenFileMoveModal,v=e.onOpenFilesDeleteModal,h=e.onAllCheckedFilesRestore,x=e.onOpenNewFolderModalItemClick,k=e.onUploadFilesItemClick,w=e.onUploadFolderItemClick,y=(0,yn.av)().hideAll;return(0,o.jsxs)(o.Fragment,{children:[0!==(null===n||void 0===n?void 0:n.length)&&(0,o.jsxs)("div",{className:Vn()["table-container"],children:[(0,o.jsx)(H.Z,{className:Vn().divider}),(0,o.jsxs)("div",{className:Vn().thead,children:[(0,o.jsxs)("span",{className:Vn()["icon-filename-container"],children:["\u540d\u79f0",a===K.d$.originalname&&(c===K.N9.DESC?(0,o.jsx)(Hn.Z,{}):(0,o.jsx)(Kn.Z,{}))]}),(0,o.jsx)("div",{className:Vn()["sort-by-time"],children:(0,o.jsxs)("span",{className:Vn().time,children:[a!==K.d$.createAt&&(c===K.N9.DESC?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\u4fee\u6539\u65f6\u95f4"}),a===K.d$.updateAt&&(0,o.jsx)(Hn.Z,{})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\u4fee\u6539\u65f6\u95f4"}),a===K.d$.updateAt&&(0,o.jsx)(Kn.Z,{})]})),a===K.d$.createAt&&(c===K.N9.DESC?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\u521b\u5efa\u65f6\u95f4"}),(0,o.jsx)(Hn.Z,{})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("span",{children:"\u521b\u5efa\u65f6\u95f4"}),(0,o.jsx)(Kn.Z,{})]}))]})}),(0,o.jsx)("span",{className:Vn().size,children:"\u5927\u5c0f"})]}),(0,o.jsx)(H.Z,{className:Vn().divider}),(0,o.jsx)("div",{className:Vn()["list-container"],onScroll:y,children:null===n||void 0===n?void 0:n.map((function(e){return(0,o.jsxs)("div",{children:[(0,o.jsx)(Sn,{file:e,checkNum:t,onFileClick:r!==K.Wi.TRASH?u:void 0,onFileCheckButtonClick:d,onAllCheckedFilesDownload:f,onAllCheckedFilesTrashed:p,onOpenRenameModal:l,onOpenDetailFileModal:s,onOpenFileMoveModal:m,onOpenFilesDeleteModal:v,fileCategory:r,onAllCheckedFilesRestore:h}),(0,o.jsx)(H.Z,{className:Vn().divider})]},e.fileId)}))})]}),n&&0===n.length&&(0,o.jsx)(Pn,{fileCategory:r,onOpenNewFolderModalItemClick:x,parentFileId:i,onUploadFilesItemClick:k,onUploadFolderItemClick:w})]})},Yn=t(73371);function Jn(){return(0,Yn.next)()}function qn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Gn(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function Qn(e){return function(e){if(Array.isArray(e))return qn(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return qn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return qn(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Xn=function(e){var n=e.parentFileId,t=e.uploadSameNameFiles,r=e.uploadReadyFiles,i=e.orderBy,c=e.orderDirection,l=e.setUploadSameNameFiles,s=e.setUploadReadyFiles,u=e.onUploadFilesItemClick,d=e.setUploadFilesNum,f=(0,j.useCallback)(function(){var e,o=(e=a().mark((function e(o){var u,f,p,m,v,h,x;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=o.target.files,f=Qn(t),p=Qn(r),!u){e.next=18;break}d(u.length),m=0;case 6:if(!(m<(null===u||void 0===u?void 0:u.length))){e.next=16;break}return v=u[m],e.next=10,en({parentFileId:n,orderBy:i,orderDirection:c,fileCategory:K.Wi.ALL,originalname:v.name});case 10:h=e.sent,x=Jn(),h.length?f.push({uploadId:x,file:v,parentFileId:n,type:K.Tv.file,sameNameMode:K.nO.AutoRename}):p.push({uploadId:x,file:v,parentFileId:n,type:K.Tv.file,sameNameMode:K.nO.AutoRename});case 13:m++,e.next=6;break;case 16:l(f),s(p);case 18:o.target.value="";case 19:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Gn(a,r,i,o,c,"next",e)}function c(e){Gn(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(e){return o.apply(this,arguments)}}(),[n,i,c,t,r]);return(0,o.jsx)("div",{onClick:u,children:(0,o.jsx)("input",{type:"file",id:"files-reader",hidden:!0,multiple:!0,onChange:f})})},et=t(16596),nt=t(13448),tt=function(e,n,t,r,i,a){var c,l=null!==(c=document.getElementById("upload-container"))&&void 0!==c?c:document.body;"uploading"===i&&nt.Z.open({key:e,duration:0,message:n,className:"notification",icon:(0,o.jsx)(et.Z,{style:{color:"#108ee9"}}),description:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",flexDirection:"column"},children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[(0,o.jsx)(jn,{fileIcon:ne(n,K.Tv.file,a)+".png",size:"small"}),(0,o.jsxs)("div",{style:{paddingLeft:"12px",paddingRight:"5px"},children:[te(t)," / ",te(r)]})]}),(0,o.jsx)(oe.Z,{percent:parseFloat((t/r*100).toFixed(2)),size:"small"})]}),placement:"bottomRight",getContainer:function(){return l}}),"done"!==i&&"success"!==i||nt.Z.success({key:e,duration:0,message:n,className:"notification",description:(0,o.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[(0,o.jsx)(jn,{fileIcon:ne(n,K.Tv.file,a)+".png",size:"small"}),(0,o.jsx)("div",{style:{paddingLeft:"12px",paddingRight:"5px"},children:te(r)})]})}),placement:"bottomRight",getContainer:function(){return l}}),"error"===i&&nt.Z.error({key:e,duration:0,message:n,className:"notification",description:(0,o.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%"},children:[(0,o.jsx)(jn,{fileIcon:ne(n,K.Tv.file,a)+".png",size:"small"}),(0,o.jsxs)("div",{style:{paddingLeft:"12px",paddingRight:"5px"},children:[te(t)," / ",te(r)]})]})}),placement:"bottomRight",getContainer:function(){return l}})};function rt(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function it(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){rt(a,r,i,o,c,"next",e)}function c(e){rt(a,r,i,o,c,"throw",e)}o(void 0)}))}}var at=function(){var e=it(a().mark((function e(n,t,r,i){var o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/quickUpload",{contentHash:n,parentFileId:t,originalname:r,sameNameMode:i});case 2:return o=e.sent,e.abrupt("return",null===o||void 0===o?void 0:o.data);case 4:case"end":return e.stop()}}),e)})));return function(n,t,r,i){return e.apply(this,arguments)}}(),ot=function(){var e=it(a().mark((function e(n){var t,r,i,o,c,l,s,u,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.uploadId,r=n.parentFileId,i=n.file,o=n.type,c=n.sameNameMode,l=new FormData,o!==K.Tv.file){e.next=16;break}return e.next=5,dt(i);case 5:return s=e.sent,e.next=8,at(s,r,i.name,c).catch(function(){var e=it(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.response.data);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 8:if("PreHashMatched"!==(u=e.sent).code){e.next=12;break}return tt(t,i.name,i.size,i.size,"success",i.type),e.abrupt("return");case 12:if("UploadFail"!==u.code){e.next=15;break}return"FreeSizeNotEnough"===u.message.split(". ")[1]&&(Z.ZP.warn("\u53ef\u7528\u5bb9\u91cf\u4e0d\u8db3\uff0c".concat(i.name,"\u4e0a\u4f20\u5931\u8d25")),tt(t,i.name,0,i.size,"error",i.type)),e.abrupt("return");case 15:l.append("contentHash",s);case 16:return l.append("file",i),l.append("type",o),l.append("parentFileId",r),l.append("sameNameMode",c),o===K.Tv.file&&tt(t,i.name,0,i.size,"uploading",i.type),e.next=23,ve.x.post("/files/upload",l,{onUploadProgress:function(e){var n=e.total,r=e.loaded;o===K.Tv.file&&tt(t,i.name,r,n,n===r?"success":"uploading",i.type)}}).catch((function(e){var n=e.response;return"UploadFail"===n.data.code&&"FreeSizeNotEnough"===n.data.message.split(". ")[1]&&(Z.ZP.warn("\u53ef\u7528\u5bb9\u91cf\u4e0d\u8db3\uff0c".concat(i.name,"\u4e0a\u4f20\u5931\u8d25")),tt(t,i.name,0,i.size,"error",i.type)),n}));case 23:return d=e.sent,e.abrupt("return",null===d||void 0===d?void 0:d.data);case 25:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();function ct(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function lt(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){ct(a,r,i,o,c,"next",e)}function c(e){ct(a,r,i,o,c,"throw",e)}o(void 0)}))}}function st(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ut(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){st(e,n,t[n])}))}return e}var dt=function(e){return new Promise((function(n){var t=new Worker("/md5-worker.js");t.postMessage(e),t.onmessage=function(e){n(e.data)}}))},ft=function(e){for(var n=[],t={},r=0,i=0;i<(null===e||void 0===e?void 0:e.length);i++){var a=e[i],o=a.webkitRelativePath,c=o.split("/").slice(0,-1).join();if(!t[c]){t[c]=!0;var l=o.split("/").slice(-2)[0],s=ae({folderName:l});n.push(ut({},s,{uploadId:Jn(),parentFileId:"",sameNameMode:K.nO.AutoRename})),r++}n.push({uploadId:Jn(),file:a,parentFileId:"",type:K.Tv.file,sameNameMode:K.nO.AutoRename}),r++}return{uploadReadyFiles:n,uploadFilesNum:r}},pt=function(){var e=lt(a().mark((function e(n,t,r){var i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.createReader(),e.next=3,i.readEntries(function(){var e=lt(a().mark((function e(n){var i,o,c,l,s,u,d,f,p;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:i=!0,o=!1,c=void 0,e.prev=1,l=n[Symbol.iterator]();case 3:if(i=(s=l.next()).done){e.next=19;break}if(!(u=s.value).isDirectory){e.next=15;break}return d=u.name,f=ae({folderName:d}),e.next=10,ot(ut({},f,{uploadId:Jn(),parentFileId:t,sameNameMode:K.nO.AutoRename}));case 10:p=e.sent.fileId,r(),pt(u,p,r),e.next=16;break;case 15:u.file(function(){var e=lt(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ot({uploadId:Jn(),parentFileId:t,file:n,type:K.Tv.file,sameNameMode:K.nO.AutoRename});case 2:r();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 16:i=!0,e.next=3;break;case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(1),o=!0,c=e.t0;case 25:e.prev=25,e.prev=26,i||null==l.return||l.return();case 28:if(e.prev=28,!o){e.next=31;break}throw c;case 31:return e.finish(28);case 32:return e.finish(25);case 33:case"end":return e.stop()}}),e,null,[[1,21,25,33],[26,,28,32]])})));return function(n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}();function mt(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function vt(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function ht(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){vt(e,n,t[n])}))}return e}var xt=function(e){var n=e.folderParentFileId,t=e.orderBy,r=e.orderDirection,i=e.setUploadReadyFiles,c=e.setUploadSameNameFiles,l=e.setShowSameNameFileModal,s=e.onUploadFolderItemClick,u=e.setUploadFilesNum,d=e.setFolderId,f=(0,j.useCallback)((function(e){e&&(e.directory=!0,e.webkitdirectory=!0)}),[]),p=(0,j.useCallback)(function(){var e,o=(e=a().mark((function e(o){var s,f,p,m,v,h,x,k,w,y;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(s=o.target.files)){e.next=8;break}return f=s[0].webkitRelativePath.split("/")[0],e.next=5,en({parentFileId:n,orderBy:t,orderDirection:r,fileCategory:K.Wi.ALL,originalname:f});case 5:p=e.sent,m=ae({folderName:f}),p.length?(c([ht({},m,{uploadId:Jn(),sameNameMode:K.nO.AutoRename,parentFileId:n})]),d(n),l(!0),v=ft(s),h=v.uploadReadyFiles,x=v.uploadFilesNum,u(x+1),i(h)):(k=ft(s),w=k.uploadReadyFiles,y=k.uploadFilesNum,d(n),u(y),i(w));case 8:o.target.value="";case 9:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){mt(a,r,i,o,c,"next",e)}function c(e){mt(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(e){return o.apply(this,arguments)}}(),[n,t,r]);return(0,o.jsx)("div",{onClick:s,children:(0,o.jsx)("input",{type:"file",id:"folder-reader",hidden:!0,onChange:p,ref:function(e){return f(e)}})})},kt=t(8100);var wt=t(68795),yt=t(17044),gt=t(78966),bt=t(87919),jt=t.n(bt),Ct=function(e){var n=e.onFileSortButtonClick,t=(0,o.jsxs)(R.Z,{style:{width:"70px"},children:[(0,o.jsxs)(gt.Z,{title:"\u5347\u5e8f",popupOffset:[-2,-5],children:[(0,o.jsx)(R.Z.Item,{onClick:function(){return n(K.d$.originalname,K.N9.ASC)},children:"\u540d\u79f0"},"1-1"),(0,o.jsx)(R.Z.Item,{onClick:function(){return n(K.d$.createAt,K.N9.ASC)},children:"\u521b\u5efa\u65f6\u95f4"},"1-2"),(0,o.jsx)(R.Z.Item,{onClick:function(){return n(K.d$.updateAt,K.N9.ASC)},children:"\u4fee\u6539\u65f6\u95f4"},"1-3")]},"1"),(0,o.jsxs)(gt.Z,{title:"\u964d\u5e8f",popupOffset:[-2,0],children:[(0,o.jsx)(R.Z.Item,{onClick:function(){return n(K.d$.originalname,K.N9.DESC)},children:"\u540d\u79f0"},"2-1"),(0,o.jsx)(R.Z.Item,{onClick:function(){return n(K.d$.createAt,K.N9.DESC)},children:"\u521b\u5efa\u65f6\u95f4"},"2-2"),(0,o.jsx)(R.Z.Item,{onClick:function(){return n(K.d$.updateAt,K.N9.DESC)},children:"\u4fee\u6539\u65f6\u95f4"},"2-3")]},"2")]});return(0,o.jsx)(L.Z,{overlay:t,placement:"bottom",arrow:!0,children:(0,o.jsxs)("div",{className:jt()["sort-container"],children:[(0,o.jsx)(yt.Z,{className:jt()["order-icon"]}),"\u6587\u4ef6\u6392\u5e8f"]})})},_t=t(92853),Nt=t.n(_t),Ft=function(e){var n=e.sum,t=e.checkAll,r=e.checkNum,i=e.indeterminate,a=e.onCheckAllButtonClick;return(0,o.jsxs)("div",{className:Nt()["list-sum-container"],children:[(0,o.jsx)(wn.Z,{className:"".concat(Nt().icon," checkbox-container"),checked:t,indeterminate:i,onClick:function(){return a(!t)}}),0!==r?"\u5df2 \u9009 ".concat(r," \u9879"):"\u5171 ".concat(n," \u9879")]})},It=t(43008),St=t(83266),At=t(64789),Ot=t(81074),Mt=t.n(Ot),Pt=function(e){var n=e.onUploadFilesItemClick,t=e.onUploadFolderItemClick,r=(0,o.jsxs)(R.Z,{children:[(0,o.jsx)(R.Z.Item,{icon:(0,o.jsx)(It.Z,{}),onClick:n,children:"\u4e0a\u4f20\u6587\u4ef6"},"1"),(0,o.jsx)(R.Z.Item,{icon:(0,o.jsx)(St.Z,{}),onClick:t,children:"\u4e0a\u4f20\u6587\u4ef6\u5939"},"2")]});return(0,o.jsx)(L.Z,{overlay:r,placement:"bottom",arrow:!0,children:(0,o.jsx)(At.Z,{className:Mt().icon})})},Et=t(13728),Zt=t(41156),Rt=t(56790),Lt=t(70054),Dt=t.n(Lt),Tt=function(e){var n=e.view,t=e.onClick,r="card"===n?(0,o.jsx)(Et.Z,{className:Dt().icon,onClick:t}):(0,o.jsx)(Zt.Z,{className:Dt().icon,onClick:t});return(0,o.jsx)(Rt.Z,{placement:"bottom",title:"\u5207\u6362\u89c6\u56fe",children:r})},Ut=t(24535),Bt=t(86801),Wt=t.n(Bt),zt=function(e){var n=e.directory,t=e.onClick,r=e.dataSize;if(n.length>5){var i=(0,o.jsx)(R.Z,{children:n.slice(1,-2).map((function(e,n){return(0,o.jsx)(R.Z.Item,{children:(0,o.jsx)("a",{onClick:function(){return t&&t(e.fileId)},children:e.originalname})},n)}))});return(0,o.jsxs)(Ut.Z,{children:[(0,o.jsx)(Ut.Z.Item,{children:(0,o.jsx)("a",{onClick:function(){return t&&t(n[0].fileId)},children:n[0].originalname})},0),(0,o.jsx)(Ut.Z.Item,{overlay:i,children:(0,o.jsx)("span",{className:Wt().ellipsis,"data-size":r,children:"..."})},"..."),n.slice(-2).map((function(e,n){return(0,o.jsx)(Ut.Z.Item,{className:1===n?Wt().active:"","data-size":r,children:(0,o.jsx)("a",{onClick:function(){return t&&t(e.fileId)},children:e.originalname})},n)}))]})}return(0,o.jsx)(Ut.Z,{children:n.map((function(e,i){return(0,o.jsx)(Ut.Z.Item,{className:i===n.length-1?Wt().active:"","data-size":r,children:t?(0,o.jsx)("a",{onClick:function(){return t&&t(e.fileId)},children:e.originalname}):e.originalname},i)}))})},Vt=t(19844),Ht=t.n(Vt),Kt=function(e){var n=e.onBreadCrumbClick,t=e.onSearchButtonClick,r=e.listSum,i=e.viewType,a=e.pathPartition,c=e.onViewSwitchButtonClick,l=e.onUploadCollapseButtonClick,s=e.onUploadFilesItemClick,u=e.onUploadFolderItemClick,d=e.checkAll,f=e.checkNum,p=e.indeterminate,m=e.onCheckAllButtonClick,v=e.onFileSortButtonClick;return(0,o.jsxs)("div",{children:[(0,o.jsxs)("div",{className:Ht()["header-line-one"],children:[(0,o.jsx)("div",{className:Ht().path,children:(0,o.jsx)(zt,{directory:a,onClick:n,dataSize:"XS"})}),(0,o.jsxs)("div",{className:Ht().action,children:[t?(0,o.jsx)(Rt.Z,{placement:"bottom",title:"\u6587\u4ef6\u641c\u7d22",children:(0,o.jsx)(wt.Z,{className:Ht()["search-icon"],onClick:function(){return t(!0)}})}):null,s?(0,o.jsx)("div",{className:Ht()["upload-menu"],children:(0,o.jsx)(Pt,{onUploadFilesItemClick:s,onUploadFolderItemClick:u})}):null,l?(0,o.jsx)(Rt.Z,{placement:"bottom",title:"\u6253\u5f00\u4e0a\u4f20\u9762\u677f",children:(0,o.jsx)(et.Z,{className:Ht()["upload-icon"],onClick:l})}):null]})]}),0!==r&&(0,o.jsxs)("div",{className:Ht()["header-line-two"],children:[(0,o.jsx)("div",{className:Ht()["list-sum"],children:(0,o.jsx)(Ft,{sum:r,checkAll:d,checkNum:f,indeterminate:p,onCheckAllButtonClick:m})}),(0,o.jsxs)("div",{className:Ht().action,children:[v?(0,o.jsx)(Ct,{onFileSortButtonClick:v,children:"\u6587\u4ef6\u6392\u5e8f"}):null,(0,o.jsx)(Tt,{view:i,onClick:c})]})]})]})},$t=t(51743),Yt=t.n($t),Jt=t(2520),qt=t.n(Jt),Gt=t(30309),Qt=(t(85687),function(e){var n=e.subtype,t=e.source,r=e.visible,i=e.onCloseButtonClick,a=e.previewFile;return(0,j.useEffect)((function(){var e=function(e){27!==e.which&&27!==e.keyCode||i(!1)};return document.body.addEventListener("keydown",e),function(){document.body.removeEventListener("keydown",e)}}),[i]),r?(0,o.jsxs)("div",{className:"modal-container",children:[(0,o.jsx)("div",{className:qt().bg,onClick:function(){return i(!1)}}),(0,o.jsxs)("div",{className:qt()["previewer-modal"],children:[(0,o.jsxs)("header",{className:qt().header,children:[(0,o.jsx)("span",{className:qt().title,children:a.originalname}),(0,o.jsx)("span",{className:qt()["close-icon"],onClick:function(){return i(!1)},children:(0,o.jsx)(ue.Z,{})})]}),(0,o.jsx)("hr",{className:qt().divider}),(0,o.jsxs)("section",{className:qt().content,children:[n===K.LV.txt&&(0,o.jsx)("div",{className:qt()["text-preview"],children:t}),n===K.LV.markdown&&(0,o.jsx)("div",{className:"markdown-body",children:(0,o.jsx)(Gt.Z,{children:t})}),n===K.LV.image&&(0,o.jsx)("div",{className:qt()["image-preview"],children:a.size&&a.size<5120?(0,o.jsx)("img",{src:a.url,alt:a.originalname,width:"20%"}):(0,o.jsx)("img",{src:a.url,alt:a.originalname,width:"90%"})}),n===K.LV.music&&(0,o.jsxs)("div",{className:qt()["music-preview"],children:[(0,o.jsx)("div",{className:qt().cover,children:(0,o.jsx)("img",{src:a.cover?a.cover:"/music-cover.png",width:"60%"})}),(0,o.jsx)("audio",{src:a.url,controls:!0})]}),n===K.LV.video&&(0,o.jsx)("div",{className:qt()["video-preview"],children:(0,o.jsx)("video",{src:a.url,controls:!0,height:"80%"})}),("word"===n||"ppt"===n||"excel"===n||"zip"===n||"pdf"===n||"white"===n)&&(0,o.jsxs)("div",{className:qt()["other-preview"],children:[(0,o.jsx)(jn,{fileIcon:ne(a.originalname,a.type,a.mimetype)+".png"}),(0,o.jsx)("span",{className:qt().originalname,children:a.originalname}),(0,o.jsx)("span",{children:"\u6682\u4e0d\u652f\u6301\u5728\u7ebf\u9884\u89c8\uff0c\u6211\u4eec\u4f1a\u6301\u7eed\u4f18\u5316\uff0c\u656c\u8bf7\u671f\u5f85"})]})]})]})]}):null}),Xt=t(10815),er=t(85951),nr=t.n(er);function tr(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var rr=function(e){var n=e.renamedfile,t=e.show,r=e.setShowRenameModal,i=e.getFiles,c=(0,j.useState)(!1),l=c[0],s=c[1],u=(0,j.useState)(n),d=u[0],f=u[1],p=(0,j.useState)(ie(n)),m=p[0],v=p[1],h=(0,j.useState)(re(n)),x=h[0],k=h[1],w=(0,j.useCallback)((function(e){v(e.target.value)}),[]),y=function(){var e,n=(e=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s(!0),e.next=3,Qe({fileId:d.fileId,newName:m+(x?"."+x:"")});case 3:n=e.sent.code,s(!1),n&&"AlreadyExist.File"===n?Z.ZP.error({content:"\u5b58\u5728\u540c\u540d\u6587\u4ef6\uff0c\u8bf7\u4fee\u6539\u6587\u4ef6\u540d\u79f0",className:"message"}):(r(!1),i());case 6:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){tr(a,r,i,o,c,"next",e)}function c(e){tr(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),g=function(){r(!1)};return(0,j.useEffect)((function(){f(n)}),[n]),(0,j.useEffect)((function(){v(ie(d)),k(re(d))}),[d]),(0,o.jsxs)(be.Z,{title:"\u91cd\u547d\u540d",visible:t,onOk:y,onCancel:g,centered:!0,width:"420px",className:"modal-container",closable:!1,destroyOnClose:!0,footer:[(0,o.jsx)(je.Z,{type:"primary",onClick:y,loading:l,disabled:!m,className:"button",children:"\u786e\u8ba4"},"submit")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:g}),(0,o.jsxs)("div",{className:nr()["modal-body"],children:[(0,o.jsx)("div",{className:nr()["file-icon"],children:d&&(0,o.jsx)(jn,{fileIcon:ne(d.originalname,null===d||void 0===d?void 0:d.type,null===d||void 0===d?void 0:d.mimetype)+".png"})}),(0,o.jsx)(Xt.ZP,{value:m,onChange:w,autoFocus:!0,onPressEnter:y,className:"input"})]})]})},ir=t(83162),ar=t.n(ir);function or(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var cr=function(e){var n=e.show,t=e.setShowDetailFileModal,r=e.detailFile,i=e.pathPartition,c=function(){t(!1)},l=(0,j.useState)(0),s=l[0],u=l[1],d=(0,j.useState)(!1),f=d[0],p=d[1];return(0,j.useEffect)((function(){!1===n&&(u(0),p(!1))}),[n]),(0,j.useEffect)((function(){var e;n&&(null===r||void 0===r?void 0:r.type)===K.Tv.folder&&(e=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,rn(r.fileId);case 2:n=e.sent,u(n),p(!0);case 5:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){or(a,r,i,o,c,"next",e)}function c(e){or(a,r,i,o,c,"throw",e)}o(void 0)}))})()}),[r,n]),(0,o.jsxs)(be.Z,{title:null===r||void 0===r?void 0:r.originalname,visible:n,onCancel:c,centered:!0,closable:!1,className:"modal-container",width:"420px",footer:null,children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:c}),(0,o.jsxs)("div",{className:ar()["modal-body"],children:[(0,o.jsx)("div",{className:ar()["file-icon"],children:r&&(0,o.jsx)(jn,{fileIcon:ne(r.originalname,null===r||void 0===r?void 0:r.type,null===r||void 0===r?void 0:r.mimetype)+".png"})}),(0,o.jsxs)("div",{className:ar()["detail-group"],children:[(0,o.jsx)("div",{className:ar()["group-name"],children:"\u8be6\u7ec6\u4fe1\u606f"}),(0,o.jsxs)("div",{className:ar()["group-item"],children:[(0,o.jsx)("div",{className:ar().title,children:null===r||void 0===r?void 0:r.originalname}),(0,o.jsx)("div",{className:ar().desc,children:(null===r||void 0===r?void 0:r.type)===K.Tv.file?te(null===r||void 0===r?void 0:r.size):f?te(s):"\u6587\u4ef6\u5927\u5c0f\u8ba1\u7b97\u4e2d..."})]}),(0,o.jsxs)("div",{className:ar()["group-item"],children:[(0,o.jsx)("div",{className:ar().title,children:"\u6587\u4ef6\u4f4d\u7f6e"}),(0,o.jsxs)("div",{className:ar().desc,children:[i.map((function(e){return e.originalname+" \u203a "})),null===r||void 0===r?void 0:r.originalname]})]}),(0,o.jsxs)("div",{className:ar()["group-item"],children:[(0,o.jsx)("div",{className:ar().title,children:"\u521b\u5efa\u65f6\u95f4"}),(0,o.jsx)("div",{className:ar().desc,children:kn(null===r||void 0===r?void 0:r.createdAt)})]}),(0,o.jsxs)("div",{className:ar()["group-item"],children:[(0,o.jsx)("div",{className:ar().title,children:"\u4fee\u6539\u65f6\u95f4"}),(0,o.jsx)("div",{className:ar().desc,children:kn(null===r||void 0===r?void 0:r.updatedAt)})]})]})]})]})},lr=t(88811),sr=t.n(lr);function ur(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function dr(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function fr(e){return function(e){if(Array.isArray(e))return ur(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return ur(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return ur(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var pr=function(e){var n=e.show,t=e.movedFile,r=e.orderBy,i=e.orderDirection,c=e.initialPath,l=e.setShowFileMoveModal,s=e.fileId,u=e.onConfirmFileMove,d=(0,j.useState)([]),f=d[0],p=d[1],m=(0,j.useState)(s),v=m[0],h=m[1],x=(0,j.useState)(c),k=x[0],w=x[1],y=function(){l(!1)},g=(0,j.useCallback)((function(e,n){l(!1),u(e,n)}),[]),b=(0,j.useCallback)((function(e,n,t){n===K.Wi.Folder&&(h(e),w(fr(k).concat([{originalname:t,fileId:e}])))}),[k]),C=(0,j.useCallback)((function(e){if(e!==v){var n=k.findIndex((function(n){return n.fileId===e})),t=k.slice(0,n+1);w(t),h(e)}}),[s,v,k]);return(0,j.useEffect)((function(){h(s)}),[s]),(0,j.useEffect)((function(){w(c)}),[c]),(0,j.useEffect)((function(){var e;(e=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,en({parentFileId:v,orderBy:r,orderDirection:i,fileCategory:K.Wi.ALL});case 2:n=e.sent,p(n);case 4:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){dr(a,r,i,o,c,"next",e)}function c(e){dr(a,r,i,o,c,"throw",e)}o(void 0)}))})()}),[v,r,i,t]),(0,o.jsxs)(be.Z,{title:"\u6587\u4ef6\u79fb\u52a8",visible:n,onCancel:y,width:"450px",className:"modal-container",closable:!1,footer:[(0,o.jsx)(je.Z,{type:"ghost",onClick:y,className:"button",children:"\u53d6\u6d88"},"cancel"),(0,o.jsx)(je.Z,{type:"primary",onClick:function(){return g(v,t)},className:"button",children:"\u79fb\u52a8\u5230\u6b64\u5904"},"confirm")],destroyOnClose:!0,children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:y}),(0,o.jsxs)("div",{className:sr()["modal-body"],children:[(0,o.jsx)("div",{children:(0,o.jsx)(zt,{directory:k,onClick:C,dataSize:"XSS"})}),(0,o.jsx)("section",{className:sr()["file-list"],children:null===f||void 0===f?void 0:f.map((function(e){return(0,o.jsx)(Sn,{file:e,onFileClick:b,detailMode:!1,onlyFolderClick:!0,fileCategory:K.Wi.ALL},e.fileId)}))})]})]})},mr=function(e){var n=e.fileCategory,t=e.parentFileId,r=e.onOpenNewFolderModalItemClick,i=e.onUploadFilesItemClick,a=e.onUploadFolderItemClick,c=e.onRefreshPage,l=e.onClearTrash;return(0,o.jsxs)(yn.v2,{animation:{enter:yn.oQ.scale,exit:!1},id:n,className:"context-menu",children:[n===K.Wi.ALL&&(0,o.jsx)(yn.ck,{onClick:function(){return r(t)},children:"\u65b0\u5efa\u6587\u4ef6\u5939"},"1"),n===K.Wi.ALL&&(0,o.jsx)(yn.ck,{onClick:i,children:"\u4e0a\u4f20\u6587\u4ef6"},"2"),n===K.Wi.ALL&&(0,o.jsx)(yn.ck,{onClick:a,children:"\u4e0a\u4f20\u6587\u4ef6\u5939"},"3"),n===K.Wi.TRASH&&(0,o.jsx)(yn.ck,{onClick:l,children:"\u6e05\u7a7a\u56de\u6536\u7ad9"},"4"),(0,o.jsx)(yn.ck,{onClick:c,children:"\u5237\u65b0\u9875\u9762"},"5")]})},vr=t(82898),hr=t.n(vr);function xr(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function kr(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function wr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){kr(e,n,t[n])}))}return e}var yr=function(e){var n=e.show,t=e.parentFileId,r=e.setShowNewFolderModal,i=e.getFiles,c=(0,j.useState)("\u65b0\u5efa\u6587\u4ef6\u5939"),l=c[0],s=c[1],u=(0,j.useState)(!1),d=u[0],f=u[1],p=function(){s("\u65b0\u5efa\u6587\u4ef6\u5939"),r(!1)},m=function(){var e,n=(e=a().mark((function e(){var n,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f(!0),n=ae({folderName:l}),e.next=4,ot(wr({},n,{uploadId:Jn(),sameNameMode:K.nO.AutoRename,parentFileId:t}));case 4:o=e.sent.code,f(!1),o&&"AlreadyExist.File"===o?Z.ZP.error({content:"\u5b58\u5728\u540c\u540d\u6587\u4ef6\uff0c\u8bf7\u4fee\u6539\u6587\u4ef6\u540d\u79f0",className:"message"}):(r(!1),s("\u65b0\u5efa\u6587\u4ef6\u5939"),i());case 7:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){xr(a,r,i,o,c,"next",e)}function c(e){xr(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}(),v=(0,j.useCallback)((function(e){s(e.target.value)}),[]);return(0,o.jsxs)(be.Z,{title:"\u65b0\u5efa\u6587\u4ef6\u5939",visible:n,onOk:m,onCancel:p,centered:!0,closable:!1,className:"modal-container",width:"420px",destroyOnClose:!0,footer:[(0,o.jsx)(je.Z,{type:"primary",onClick:m,loading:d,disabled:!l,className:"button",children:"\u786e\u8ba4"},"submit")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:p}),(0,o.jsxs)("div",{className:hr()["modal-body"],children:[(0,o.jsx)("div",{className:hr()["file-icon"],children:(0,o.jsx)(jn,{fileIcon:"folder.png"})}),(0,o.jsx)(Oe.Z,{value:l,onChange:v,autoFocus:!0,onPressEnter:m,className:"input"})]})]})},gr=t(20190),br=t.n(gr);function jr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Cr(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function _r(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Cr(a,r,i,o,c,"next",e)}function c(e){Cr(a,r,i,o,c,"throw",e)}o(void 0)}))}}function Nr(e){return function(e){if(Array.isArray(e))return jr(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return jr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return jr(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Fr=function(e){var n,t,r,i,c=e.show,l=e.uploadMode,s=e.uploadSameNameFiles,u=e.restoreOrMoveSameNameFiles,d=e.restoreOrMoveReadyFiles,f=e.uploadReadyFiles,p=e.uploadFilesNum,m=e.setUploadSameNameFiles,v=e.setUploadReadyFiles,h=e.setShowSameNameFileModal,x=e.setRestoreOrMoveSameNameFiles,k=e.setRestoreOrMoveReadyFiles,w=e.getFiles,y=e.setUploadFilesNum,g=e.setFolderId,b=(0,j.useState)(0),C=b[0],_=b[1],N=function(){h(!1)},F=(0,j.useCallback)((function(){_(C+1)}),[C]),I=(0,j.useCallback)(_r(a().mark((function e(){var n,t,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=16;break}if((n=s[C]).sameNameMode=K.nO.Overwrite,n.type!==K.Tv.folder){e.next=13;break}return e.next=6,ot(n);case 6:t=e.sent.fileId,g(t),r=f.slice(1),v(r),y(p-2),e.next=14;break;case 13:v(Nr(f).concat([n]));case 14:e.next=17;break;case 16:(i=u[C]).sameNameMode=K.nO.Overwrite,k(Nr(d).concat([i]));case 17:_(C+1);case 18:case"end":return e.stop()}}),e)}))),[l,C,s,f,u,d]),S=(0,j.useCallback)(_r(a().mark((function e(){var n,t,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=15;break}if((n=s[C]).type!==K.Tv.folder){e.next=12;break}return e.next=5,ot(n);case 5:t=e.sent.fileId,g(t),r=f.slice(1),v(r),y(p-2),e.next=13;break;case 12:v(Nr(f).concat([n]));case 13:e.next=16;break;case 15:i=u[C],k(Nr(d).concat([i]));case 16:_(C+1);case 17:case"end":return e.stop()}}),e)}))),[l,C,s,f,u,d]);return(0,j.useEffect)((function(){l&&C===s.length?h(!1):C===u.length&&(_r(a().mark((function e(){var n,t,r,i,o,c;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,t=!1,r=void 0,e.prev=1,i=d[Symbol.iterator]();case 3:if(n=(o=i.next()).done){e.next=11;break}return c=o.value,e.next=7,tn(c);case 7:w();case 8:n=!0,e.next=3;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),t=!0,r=e.t0;case 17:e.prev=17,e.prev=18,n||null==i.return||i.return();case 20:if(e.prev=20,!t){e.next=23;break}throw r;case 23:return e.finish(20);case 24:return e.finish(17);case 25:case"end":return e.stop()}}),e,null,[[1,13,17,25],[18,,20,24]])})))(),h(!1))}),[l,C]),(0,j.useEffect)((function(){c||(m([]),k([]),x([]),_(0))}),[c]),(0,o.jsxs)(be.Z,{title:"\u68c0\u6d4b\u5230".concat(!0===l?s.length:u.length,"\u4e2a\u540c\u540d\u6587\u4ef6"),visible:c,onCancel:N,width:"450px",className:"modal-container",centered:!0,closable:!1,footer:[(0,o.jsx)(je.Z,{type:"ghost",onClick:F,className:"button",children:"\u8df3\u8fc7"},"skip"),(0,o.jsx)(je.Z,{type:"ghost",onClick:I,className:"button",children:"\u8986\u76d6"},"cancel"),(0,o.jsx)(je.Z,{type:"primary",onClick:function(){return S()},className:"button",children:"\u4fdd\u7559\u4e24\u8005"},"confirm")],destroyOnClose:!0,children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:N}),(0,o.jsxs)("section",{children:["\u6587\u4ef6\u540d"," ",!0===l?null===(n=s[C===s.length?C-1:C])||void 0===n?void 0:n.file.name:null===(t=u[C===u.length?C-1:C])||void 0===t?void 0:t.originalname," ","\u5df2\u5b58\u5728\uff0c\u662f\u5426\u9700\u8981\u7ee7\u7eed\uff1f",(0,o.jsxs)("span",{style:{color:"#c2c2c2"},children:[C===(!0===l?s.length:u.length)?"(".concat(C," "):"(".concat(C+1," "),"/"," ","".concat(!0===l?s.length:u.length,")")]}),!0!==l&&(0,o.jsxs)("div",{className:br()["path-container"],children:[(0,o.jsx)("p",{children:"\u76ee\u7684\u5730\u8def\u5f84\uff1a"}),(0,o.jsx)("p",{children:(null===(r=u[C===u.length?C-1:C])||void 0===r?void 0:r.destinatinFilePath.map((function(e){return e.originalname+" \u203a "})).join(""))+(null===(i=u[C===u.length?C-1:C])||void 0===i?void 0:i.originalname)})]})]})]})};Fr.defaultProps={uploadMode:!0};var Ir=function(e){var n=e.show,t=e.setShowFilesDeleteModal,r=e.onConfirmAllCheckedFilesDeleted,i=function(){t(!1)},a=(0,j.useCallback)((function(){r(),t(!1)}),[r]);return(0,o.jsxs)(be.Z,{title:"\u5220\u9664\u6587\u4ef6",visible:n,onCancel:i,width:"450px",className:"modal-container",closable:!1,centered:!0,footer:[(0,o.jsx)(je.Z,{type:"ghost",onClick:i,className:"button",children:"\u53d6\u6d88"},"cancel"),(0,o.jsx)(je.Z,{danger:!0,type:"primary",onClick:function(){return a()},className:"button",children:"\u5f7b\u5e95\u5220\u9664"},"confirm")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:i}),(0,o.jsx)("div",{children:"\u5220\u9664\u7684\u6587\u4ef6\u6682\u4e0d\u652f\u6301\u627e\u56de\uff0c\u662f\u5426\u786e\u8ba4\u5f7b\u5e95\u5220\u9664\uff1f"})]})},Sr=t(62498);function Ar(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var Or=function(e){var n=e.show,t=e.setShowFolderDownloadModal,r=function(){t(!1)},i=function(){var e,n=(e=a().mark((function e(){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(!1);case 1:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Ar(a,r,i,o,c,"next",e)}function c(e){Ar(a,r,i,o,c,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,o.jsxs)(be.Z,{title:"\u6682\u4e0d\u652f\u6301\u6587\u4ef6\u5939\u4e0b\u8f7d",visible:n,onOk:i,onCancel:r,centered:!0,closable:!1,className:"modal-container",width:"420px",destroyOnClose:!0,footer:[(0,o.jsx)(je.Z,{type:"primary",onClick:i,className:"button",children:"\u786e\u8ba4"},"submit")],children:[(0,o.jsx)(ue.Z,{className:"close-button",onClick:r}),"\u5f53\u524d\u4e0b\u8f7d\u542b\u6709\u6587\u4ef6\u5939\uff0c\u6682\u4e0d\u652f\u6301\u6587\u4ef6\u5939\u4e0b\u8f7d\u3002"]})};function Mr(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Pr(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}function Er(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function o(e){Pr(a,r,i,o,c,"next",e)}function c(e){Pr(a,r,i,o,c,"throw",e)}o(void 0)}))}}function Zr(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Rr(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){Zr(e,n,t[n])}))}return e}function Lr(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}function Dr(e){return function(e){if(Array.isArray(e))return Mr(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return Mr(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Mr(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Tr=function(e){var n=e.title,t=e.fileCategory,r=e.onUpdateCapacity,i=(0,j.useState)(!1),c=i[0],l=i[1],s=(0,j.useContext)(Sr.s).toggleShowUploadCollapse,u=(0,j.useState)(!1),d=u[0],f=u[1],p=(0,j.useState)(!1),m=p[0],v=p[1],h=(0,j.useState)(!1),x=h[0],k=h[1],w=(0,j.useState)(!1),y=w[0],g=w[1],b=(0,j.useState)(!1),C=b[0],_=b[1],N=(0,j.useState)(!1),F=N[0],I=N[1],S=(0,j.useState)(!1),A=S[0],O=S[1],M=(0,j.useState)(!1),P=M[0],E=M[1],R=(0,j.useState)(!1),L=R[0],D=R[1],T=(0,j.useState)([]),U=T[0],B=T[1],W=(0,j.useState)([]),z=W[0],V=W[1],H=(0,j.useState)(0),$=H[0],Y=H[1],J=(0,j.useState)(""),q=J[0],G=J[1],Q=(0,j.useState)(t!==K.Wi.TRASH),X=Q[0],ee=Q[1],te=(0,j.useState)([]),re=te[0],ie=te[1],oe=(0,j.useState)([]),ce=oe[0],le=oe[1],se=(0,j.useState)(),ue=se[0],de=se[1],fe=(0,j.useState)(),pe=fe[0],me=fe[1],he=(0,j.useState)(),xe=he[0],ke=he[1],we=(0,j.useState)(),ye=we[0],ge=we[1],be=(0,j.useState)(!1),je=be[0],Ce=be[1],_e=(0,j.useState)({}),Ne=_e[0],Fe=_e[1],Ie=(0,j.useState)(K.LV.white),Se=Ie[0],Ae=Ie[1],Oe=(0,j.useState)(),Me=Oe[0],Pe=Oe[1],Ee=(0,j.useState)("card"),Ze=Ee[0],Re=Ee[1],Le=(0,j.useCallback)((function(){return Re("table"===Ze?"card":"table")}),[Ze,Re]),De=(0,j.useState)("root"),Te=De[0],Ue=De[1],Be=(0,j.useState)(K.d$.originalname),We=Be[0],ze=Be[1],Ve=(0,j.useState)(K.N9.DESC),He=Ve[0],Ke=Ve[1],$e=(0,j.useState)([{originalname:"".concat(n),fileId:"root"}]),Ye=$e[0],Qe=$e[1],rn=(0,j.useState)(!1),on=rn[0],cn=rn[1],ln=(0,j.useState)(!1),sn=ln[0],un=ln[1],dn=(0,j.useState)(0),fn=dn[0],pn=dn[1],mn=function(e){var n=e.parentFileId,t=e.orderBy,r=e.orderDirection,i=e.fileCategory,a=e.trashed,o=e.originalname,c=(0,kt.ZP)("/files/find",(function(e){return ve.x.post(e,{parentFileId:n,orderBy:t,orderDirection:r,limit:100,fileCategory:i,trashed:a,originalname:o}).then((function(e){return e.data}))})),l=c.data,s=c.mutate,u=c.error;return{isLoading:!l&&!u,fileList:l,getFiles:s,error:u}}({parentFileId:t===K.Wi.ALL?Te:void 0,orderBy:We,orderDirection:He,fileCategory:t,trashed:t===K.Wi.TRASH,originalname:t===K.Wi.ALL?void 0:"%"}),vn=mn.fileList,hn=mn.getFiles,xn=(0,j.useState)(),kn=xn[0],wn=xn[1],gn=(0,yn.av)(),bn=gn.show,jn=gn.hideAll,Cn=(0,j.useCallback)((function(e){jn(),bn(e,{id:t}),e.stopPropagation()}),[t]),_n=(0,j.useCallback)((function(e){if(t===K.Wi.ALL&&e!==Te){un(!1),pn(0),Ue(e);var n,r=Ye.findIndex((function(n){return n.fileId===e})),i=Ye.slice(0,r+1);Qe(i),n="root"!==e?window.location.origin+"/folder/"+e:window.location.origin,window.history.pushState(null,"",n)}}),[Te]),Nn=(0,j.useCallback)(function(){var e=Er(a().mark((function e(n,t){var r,i,o,c,l,s,u,d;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(r=[]).push(t),null===kn||void 0===kn||kn.forEach((function(e){!0===e.checked&&e.fileId!==t.fileId&&r.push(e.fileId)})),i=[],o=!0,c=!1,l=void 0,e.prev=5,s=r[Symbol.iterator]();case 7:if(o=(u=s.next()).done){e.next=33;break}return d=u.value,e.next=11,en({parentFileId:n,orderBy:We,orderDirection:He,fileCategory:K.Wi.ALL,originalname:d.originalname});case 11:if(!e.sent.length){e.next=27;break}return e.t0=i,e.t1=Rr,e.t2={},e.t3=d,e.t4=K.nO.AutoRename,e.t5=d.parentFileId,e.next=21,Gn(n);case 21:e.t6=e.sent,e.t7={sameNameMode:e.t4,newParentFileId:e.t5,destinatinFilePath:e.t6},e.t8=(0,e.t1)(e.t2,e.t3,e.t7),e.t0.push.call(e.t0,e.t8),e.next=30;break;case 27:return e.next=29,tn({fileId:d.fileId,sameNameMode:K.nO.AutoRename,newParentFileId:n});case 29:hn();case 30:o=!0,e.next=7;break;case 33:e.next=39;break;case 35:e.prev=35,e.t9=e.catch(5),c=!0,l=e.t9;case 39:e.prev=39,e.prev=40,o||null==s.return||s.return();case 42:if(e.prev=42,!c){e.next=45;break}throw l;case 45:return e.finish(42);case 46:return e.finish(39);case 47:i.length&&(ee(!1),ie(i),I(!0)),hn();case 49:case"end":return e.stop()}}),e,null,[[5,35,39,47],[40,,42,46]])})));return function(n,t){return e.apply(this,arguments)}}(),[]),Fn=(0,j.useCallback)((function(){v(!0)}),[]),In=(0,j.useCallback)(function(){var e=Er(a().mark((function e(n,t,r){var i,o,c,l,s,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==K.Wi.TRASH){e.next=2;break}return e.abrupt("return");case 2:if(t!==K.Wi.Folder){e.next=9;break}return un(!1),pn(0),i=window.location.origin+"/folder/"+n,window.history.pushState(null,"",i),Qe(Dr(Ye).concat([{originalname:r,fileId:n}])),e.abrupt("return");case 9:return o=ne(r),Ae(o),e.next=13,Je({fileId:n,fileCategory:t});case 13:if(c=e.sent,l=c.code,s=Lr(c,["code"]),Fe(s),o!==K.LV.markdown&&o!==K.LV.txt){e.next=25;break}return e.next=20,qe(s.url,o);case 20:(u=e.sent)&&Pe(u),Ce(!0),e.next=26;break;case 25:o===K.LV.image?(Pe(s.url),Ce(!0)):o===K.LV.music?(Pe(s),Ce(!0)):o===K.LV.video?"VideoTranscoding"===l?Z.ZP.loading("\u89c6\u9891\u8f6c\u7801\u4e2d"):(Pe(s),Ce(!0)):Ce(!0);case 26:case"end":return e.stop()}}),e)})));return function(n,t,r){return e.apply(this,arguments)}}(),[Ye]),Sn=(0,j.useCallback)((function(e){var n,t;e?(n=null===kn||void 0===kn?void 0:kn.map((function(e){return e.checked=!0,e})),pn(null!==(t=null===kn||void 0===kn?void 0:kn.length)&&void 0!==t?t:0)):(n=null===kn||void 0===kn?void 0:kn.map((function(e){return e.checked=!1,e})),pn(0));wn(n),un(e)}),[kn]),An=(0,j.useCallback)((function(e){var n=null===kn||void 0===kn?void 0:kn.map((function(n){return n.fileId===e&&(n.checked=!n.checked,!0===n.checked?pn(fn+1):pn(fn-1)),n}));wn(n)}),[kn]),Mn=(0,j.useCallback)((function(e){if(e.type!==K.Tv.folder){var n=[];if(kn){var t=!0,r=!1,i=void 0;try{for(var o,c=kn[Symbol.iterator]();!(t=(o=c.next()).done);t=!0){var l=o.value;if(!0===l.checked){if(l.type===K.Tv.folder)return void O(!0);n.push(l)}}}catch(s){r=!0,i=s}finally{try{t||null==c.return||c.return()}finally{if(r)throw i}}}n.find((function(n){return n.fileId===e.fileId}))||n.push(e),n.forEach(function(){var e=Er(a().mark((function e(n){var t,r;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.fileId,e.next=3,Je({fileId:t,needDownload:!0});case 3:r=e.sent.url,Ge(r);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}else O(!0)}),[kn]),Pn=(0,j.useCallback)(function(){var e=Er(a().mark((function e(n){var t,r,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=[]).push(n),null===kn||void 0===kn||kn.forEach((function(e){!0===e.checked&&e.fileId!==n&&t.push(e.fileId)})),e.next=5,Xe(t);case 5:r=e.sent,i=r.responses,"TrashedSuccess"===r.code?Z.ZP.success("\u6587\u4ef6\u5df2\u79fb\u5230\u56de\u6536\u7ad9"):i.foreEach((function(e){"204"!==e.status&&Z.ZP.error(e.originalname+"\u79fb\u5165\u56de\u6536\u7ad9\u5931\u8d25")})),hn();case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[kn]),En=(0,j.useCallback)(Er(a().mark((function e(){var n,t,i;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=[]).push(ye),null===kn||void 0===kn||kn.forEach((function(e){!0===e.checked&&e.fileId!==ye&&n.push(e.fileId)})),e.next=5,nn(n);case 5:t=e.sent,i=t.responses,"DeletedSuccess"===t.code?Z.ZP.success("\u6587\u4ef6\u5220\u9664\u6210\u529f"):i.foreEach((function(e){"204"!==e.status&&Z.ZP.error(e.originalname+"\u5220\u9664\u5931\u8d25")})),hn(),r();case 11:case"end":return e.stop()}}),e)}))),[kn,ye]),Zn=(0,j.useCallback)(Er(a().mark((function e(){var n,t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,an();case 2:n=e.sent,t=n.responses,"DeletedSuccess"===n.code?Z.ZP.success("\u56de\u6536\u7ad9\u6e05\u7a7a\u6210\u529f"):t.foreEach((function(e){"204"!==e.status&&Z.ZP.error(e.originalname+"\u5220\u9664\u5931\u8d25")})),hn(),r();case 8:case"end":return e.stop()}}),e)}))),[]),Rn=(0,j.useCallback)(Er(a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return wn(void 0),e.next=3,en({parentFileId:Te,orderBy:We,orderDirection:He,fileCategory:t===K.Wi.TRASH?K.Wi.ALL:t,trashed:t===K.Wi.TRASH});case 3:(n=e.sent)&&wn(n.map((function(e){return e.checked=!1,e}))),pn(0);case 6:case"end":return e.stop()}}),e)}))),[Te,We,He,t]),Ln=(0,j.useCallback)(function(){var e=Er(a().mark((function e(n){var t,r,i,o,c,l,s,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=[]).push(n),null===kn||void 0===kn||kn.forEach((function(e){!0===e.checked&&e.fileId!==n.fileId&&t.push(e)})),r=[],i=!0,o=!1,c=void 0,e.prev=5,l=t[Symbol.iterator]();case 7:if(i=(s=l.next()).done){e.next=33;break}return u=s.value,e.next=11,en({parentFileId:u.parentFileId,orderBy:We,orderDirection:He,fileCategory:K.Wi.ALL,originalname:u.originalname});case 11:if(!e.sent.length){e.next=27;break}return e.t0=r,e.t1=Rr,e.t2={},e.t3=u,e.t4=K.nO.AutoRename,e.t5=u.parentFileId,e.next=21,Gn(u.parentFileId);case 21:e.t6=e.sent,e.t7={sameNameMode:e.t4,newParentFileId:e.t5,destinatinFilePath:e.t6},e.t8=(0,e.t1)(e.t2,e.t3,e.t7),e.t0.push.call(e.t0,e.t8),e.next=30;break;case 27:return e.next=29,tn({fileId:u.fileId,sameNameMode:K.nO.AutoRename,newParentFileId:u.parentFileId});case 29:hn();case 30:i=!0,e.next=7;break;case 33:e.next=39;break;case 35:e.prev=35,e.t9=e.catch(5),o=!0,c=e.t9;case 39:e.prev=39,e.prev=40,i||null==l.return||l.return();case 42:if(e.prev=42,!o){e.next=45;break}throw c;case 45:return e.finish(42);case 46:return e.finish(39);case 47:r.length&&(ie(r),I(!0));case 48:case"end":return e.stop()}}),e,null,[[5,35,39,47],[40,,42,46]])})));return function(n){return e.apply(this,arguments)}}(),[kn,ye]),Dn=(0,j.useCallback)((function(e){me(e),f(!0)}),[]),Tn=(0,j.useCallback)((function(e){de(e),g(!0)}),[]),Un=(0,j.useCallback)((function(e,n){ze(e),Ke(n),localStorage.setItem("orderBy",e),localStorage.setItem("orderDirection",n)}),[]),Bn=(0,j.useCallback)((function(e){ke(e),_(!0)}),[]),zn=(0,j.useCallback)((function(e){ge(e),k(!0)}),[]),Vn=(0,j.useCallback)((function(){ee(!0);var e=document.getElementById("files-reader");null===e||void 0===e||e.click()}),[]),Hn=(0,j.useCallback)((function(){ee(!0);var e=document.getElementById("folder-reader");null===e||void 0===e||e.click()}),[]),Kn=(0,j.useCallback)(function(){var e=Er(a().mark((function e(n){var t,i,o,c,l,u,d,f;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stopPropagation(),n.preventDefault(),E(!1),D(!1),t=n.dataTransfer.items,i=[],o=!0,c=!1,l=void 0,e.prev=7,u=t[Symbol.iterator]();case 9:if(o=(d=u.next()).done){e.next=17;break}if(f=d.value,i.push(f),"file"===f.kind){e.next=14;break}return e.abrupt("return");case 14:o=!0,e.next=9;break;case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(7),c=!0,l=e.t0;case 23:e.prev=23,e.prev=24,o||null==u.return||u.return();case 26:if(e.prev=26,!c){e.next=29;break}throw l;case 29:return e.finish(26);case 30:return e.finish(23);case 31:ee(!0),s(!0),i.forEach(function(){var e=Er(a().mark((function e(n){var t,i,o;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=null===n||void 0===n?void 0:n.webkitGetAsEntry()).isDirectory){e.next=10;break}return i=ae({folderName:t.name}),e.next=5,ot(Rr({},i,{uploadId:Jn(),sameNameMode:K.nO.AutoRename,parentFileId:Te}));case 5:return o=e.sent,e.next=8,pt(t,o.fileId,(function(){hn(),r()}));case 8:e.next=11;break;case 10:t.file(function(){var e=Er(a().mark((function e(n){return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ot({uploadId:Jn(),file:n,parentFileId:Te,type:K.Tv.file,sameNameMode:K.nO.AutoRename});case 2:hn(),r();case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 11:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 34:case"end":return e.stop()}}),e,null,[[7,19,23,31],[24,,26,30]])})));return function(n){return e.apply(this,arguments)}}(),[Te]);(0,j.useEffect)((function(){U.length&&U.length+z.length===$&&I(!0)}),[U,z,$]),(0,j.useEffect)((function(){if(q&&0!==$&&z.length===$){var e=q;s(!0),Er(a().mark((function n(){var t,i,o,c,l,s,u;return a().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=!0,i=!1,o=void 0,n.prev=1,c=z[Symbol.iterator]();case 3:if(t=(l=c.next()).done){n.next=19;break}if((s=l.value).type!==K.Tv.file){n.next=10;break}return n.next=8,ot({uploadId:s.uploadId,parentFileId:e,file:s.file,type:s.type,sameNameMode:s.sameNameMode});case 8:n.next=14;break;case 10:return n.next=12,ot({uploadId:s.uploadId,parentFileId:e,file:s.file,type:s.type,sameNameMode:s.sameNameMode});case 12:u=n.sent.fileId,e=u;case 14:hn(),r();case 16:t=!0,n.next=3;break;case 19:n.next=25;break;case 21:n.prev=21,n.t0=n.catch(1),i=!0,o=n.t0;case 25:n.prev=25,n.prev=26,t||null==c.return||c.return();case 28:if(n.prev=28,!i){n.next=31;break}throw o;case 31:return n.finish(28);case 32:return n.finish(25);case 33:Y(0),V([]),G("");case 36:case"end":return n.stop()}}),n,null,[[1,21,25,33],[26,,28,32]])})))()}q||0===$||$!==z.length||(s(!0),Er(a().mark((function e(){var n,t,i,o,c,l;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!0,t=!1,i=void 0,e.prev=1,o=z[Symbol.iterator]();case 3:if(n=(c=o.next()).done){e.next=11;break}return l=c.value,e.next=7,ot(l);case 7:hn();case 8:n=!0,e.next=3;break;case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),t=!0,i=e.t0;case 17:e.prev=17,e.prev=18,n||null==o.return||o.return();case 20:if(e.prev=20,!t){e.next=23;break}throw i;case 23:return e.finish(20);case 24:return e.finish(17);case 25:Y(0),V([]),r();case 28:case"end":return e.stop()}}),e,null,[[1,13,17,25],[18,,20,24]])})))())}),[q,z,$]);var Yn=(0,j.useCallback)((function(e){e.stopPropagation(),e.preventDefault();var n=e.dataTransfer.items,t=!0,r=!1,i=void 0;try{for(var a,o=n[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){if("file"!==a.value.kind)return}}catch(c){r=!0,i=c}finally{try{t||null==o.return||o.return()}finally{if(r)throw i}}D(!0)}),[]),qn=(0,j.useCallback)((function(e){e.stopPropagation(),e.preventDefault(),E(!1),D(!1)}),[]);(0,j.useEffect)((function(){L&&E(!0)}),[L]);var Gn=(0,j.useCallback)(function(){var e=Er(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/path",{fileId:n}).catch(console.error);case 2:return t=e.sent,e.abrupt("return",null===t||void 0===t?void 0:t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[]);return(0,j.useEffect)((function(){var e=localStorage.getItem("orderBy");e&&(e===K.d$.createAt||e===K.d$.originalname||e===K.d$.updateAt)&&ze(e);var n=localStorage.getItem("orderDirection");n&&(n===K.N9.ASC||n===K.N9.DESC)&&Ke(n)}),[]),(0,j.useEffect)((function(){if(t===K.Wi.ALL){var e=function(){var e=window.location.href.split("folder/")[1]||"root",n=function(){var e=Er(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/path",{fileId:n}).catch((function(e){return e}));case 2:200===(t=e.sent).status&&t&&Qe(t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();e&&n(e)};window.addEventListener("popstate",e);var n=window.location.href.split("folder/")[1]||"root",r=function(){var e=Er(a().mark((function e(n){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.x.post("files/path",{fileId:n}).catch((function(e){return e}));case 2:200===(t=e.sent).status&&t&&Qe(t.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return n&&r(n),function(){window.removeEventListener("popstate",e)}}}),[]),(0,j.useEffect)((function(){fn!==(null===kn||void 0===kn?void 0:kn.length)?(cn(0!==fn),un(!1)):(cn(!1),un(!0))}),[kn,fn]),(0,j.useEffect)((function(){Ue(Ye.slice(-1)[0].fileId)}),[Ye]),(0,j.useEffect)((function(){hn()}),[Te,We,He]),(0,j.useEffect)((function(){var e=0;vn&&wn(vn.map((function(n){var t=null===kn||void 0===kn?void 0:kn.find((function(e){return n.fileId===e.fileId}));return t?(n.checked=t.checked,n.checked&&e++):n.checked=!1,n}))),pn(e)}),[vn]),(0,o.jsxs)("div",{className:"".concat(Yt()["content-container"]," ").concat(L?Yt()["forbidden-children-pointer-events"]:""),onDrop:t===K.Wi.ALL?function(e){return Kn(e)}:void 0,onDragEnter:t===K.Wi.ALL?function(e){return Yn(e)}:void 0,onDragLeave:t===K.Wi.ALL?function(e){return qn(e)}:void 0,onDragOver:t===K.Wi.ALL?function(e){null===e||void 0===e||e.stopPropagation(),null===e||void 0===e||e.preventDefault()}:void 0,children:[(0,o.jsx)("div",{className:"".concat(Yt().bg," ").concat(P?"":Yt().hidden),children:(0,o.jsxs)("div",{className:Yt()["upload-tip"],children:[(0,o.jsx)("img",{src:"/file-upload.svg"}),(0,o.jsxs)("span",{children:["\u4e0a\u4f20\u5230 ",Ye.slice(-1)[0].originalname]})]})}),(0,o.jsx)(Kt,{onBreadCrumbClick:t===K.Wi.ALL?_n:void 0,onSearchButtonClick:t!==K.Wi.TRASH?l:void 0,listSum:kn?kn.length:0,viewType:Ze,pathPartition:Ye,onViewSwitchButtonClick:Le,onUploadFilesItemClick:t===K.Wi.ALL?Vn:void 0,onUploadFolderItemClick:t===K.Wi.ALL?Hn:void 0,checkAll:sn,checkNum:fn,indeterminate:on,onCheckAllButtonClick:Sn,onUploadCollapseButtonClick:s,onFileSortButtonClick:t!==K.Wi.TRASH?Un:void 0}),(0,o.jsx)(On,{show:c,setShowFileSearchModal:l,fileCategory:t,orderBy:We,orderDirection:He,onFileClick:In}),(0,o.jsx)(Qt,{visible:je,subtype:Se,source:Me,previewFile:Ne,onCloseButtonClick:Ce}),(0,o.jsx)(rr,{renamedfile:pe,show:d,setShowRenameModal:f,getFiles:hn}),(0,o.jsx)(Or,{show:A,setShowFolderDownloadModal:O}),(0,o.jsx)(pr,{show:C,setShowFileMoveModal:_,movedFile:xe,initialPath:Ye,fileId:Te,orderBy:We,orderDirection:He,onConfirmFileMove:Nn}),(0,o.jsx)(yr,{show:m,setShowNewFolderModal:v,parentFileId:Te,getFiles:hn}),(0,o.jsx)(Fr,{uploadMode:X,show:F,getFiles:hn,setShowSameNameFileModal:I,setUploadSameNameFiles:B,uploadSameNameFiles:U,uploadReadyFiles:z,setUploadReadyFiles:V,restoreOrMoveSameNameFiles:re,setRestoreOrMoveSameNameFiles:ie,restoreOrMoveReadyFiles:ce,setRestoreOrMoveReadyFiles:le,uploadFilesNum:$,setUploadFilesNum:Y,setFolderId:G}),(0,o.jsx)(Ir,{show:x,setShowFilesDeleteModal:k,onConfirmAllCheckedFilesDeleted:En}),(0,o.jsx)(cr,{detailFile:ue,show:y,pathPartition:Ye,setShowDetailFileModal:g}),(0,o.jsx)(Xn,{parentFileId:Te,orderBy:We,orderDirection:He,uploadSameNameFiles:U,setUploadSameNameFiles:B,uploadReadyFiles:z,setUploadReadyFiles:V,onUploadFilesItemClick:Vn,setUploadFilesNum:Y}),(0,o.jsx)(xt,{folderParentFileId:Te,setShowSameNameFileModal:I,orderBy:We,orderDirection:He,setUploadSameNameFiles:B,setUploadReadyFiles:V,onUploadFolderItemClick:Hn,setUploadFilesNum:Y,setFolderId:G}),(0,o.jsx)("div",{className:Yt()["view-container"],onContextMenu:Cn,children:"card"===Ze?(0,o.jsx)(Wn,{files:kn,onFileClick:In,onFileCheckButtonClick:An,onAllCheckedFilesDownload:Mn,onAllCheckedFilesTrashed:Pn,onAllCheckedFilesRestore:Ln,checkNum:fn,onOpenRenameModal:Dn,onOpenDetailFileModal:Tn,onOpenFileMoveModal:Bn,onOpenFilesDeleteModal:function(e){return zn(e)},fileCategory:t,parentFileId:Te,onOpenNewFolderModalItemClick:Fn,onUploadFilesItemClick:t===K.Wi.ALL?Vn:void 0,onUploadFolderItemClick:t===K.Wi.ALL?Hn:void 0}):(0,o.jsx)($n,{files:kn,onFileClick:In,onFileCheckButtonClick:An,onAllCheckedFilesDownload:Mn,onAllCheckedFilesTrashed:Pn,onAllCheckedFilesRestore:Ln,checkNum:fn,showRenameModal:d,onOpenRenameModal:Dn,onOpenDetailFileModal:Tn,onOpenFileMoveModal:Bn,onOpenFilesDeleteModal:function(e){return zn(e)},fileCategory:t,parentFileId:Te,onOpenNewFolderModalItemClick:Fn,onUploadFilesItemClick:t===K.Wi.ALL?Vn:void 0,onUploadFolderItemClick:t===K.Wi.ALL?Hn:void 0,orderBy:We,orderDirection:He})}),(0,o.jsx)(mr,{parentFileId:Te,fileCategory:t,onOpenNewFolderModalItemClick:Fn,onUploadFilesItemClick:t===K.Wi.ALL?Vn:void 0,onUploadFolderItemClick:t===K.Wi.ALL?Hn:void 0,onRefreshPage:Rn,onClearTrash:Zn})]})};function Ur(e,n,t,r,i,a,o){try{var c=e[a](o),l=c.value}catch(s){return void t(s)}c.done?n(l):Promise.resolve(l).then(r,i)}var Br=function(e){var n,t=e.title,r=e.fileCategory,i=(0,s.useRouter)(),c=(0,j.useState)(0),u=c[0],d=c[1],f=(0,j.useState)(0),p=f[0],m=f[1],v=(0,j.useCallback)((n=a().mark((function e(){var n;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke().catch((function(e){return e}));case 2:200===(n=e.sent).status&&(m(n.data.totalSize),d(n.data.usedSize));case 4:case"end":return e.stop()}}),e)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var a=n.apply(e,t);function o(e){Ur(a,r,i,o,c,"next",e)}function c(e){Ur(a,r,i,o,c,"throw",e)}o(void 0)}))}),[]);return(0,j.useEffect)((function(){v()}),[]),(0,o.jsxs)("div",{className:l()["main-layout-container"],children:[(0,o.jsx)(Ve,{asPath:i.asPath,logoColor:"black",usedSize:u,totalSize:p}),(0,o.jsx)(Tr,{title:t,fileCategory:r,onUpdateCapacity:v})]})}},8507:function(e,n,t){"use strict";var r,i,a,o,c,l,s;t.d(n,{d$:function(){return r},N9:function(){return i},Wi:function(){return a},Tv:function(){return o},LV:function(){return l},nO:function(){return s}}),function(e){e.originalname="originalname",e.updateAt="updated_at",e.createAt="created_at"}(r||(r={})),function(e){e.ASC="ASC",e.DESC="DESC"}(i||(i={})),function(e){e.Other="Other",e.Folder="Folder",e.Zip="Zip",e.Document="Document",e.Image="Image",e.Music="Music",e.Video="Video",e.ALL="All",e.TRASH="TRASH"}(a||(a={})),function(e){e.file="file",e.folder="folder"}(o||(o={})),function(e){e.CARD_VIEW="CARD_VIEW",e.TABLE_VIEW="TABLE_VIEW"}(c||(c={})),function(e){e.word="word",e.ppt="ppt",e.excel="excel",e.txt="txt",e.markdown="markdown",e.image="image",e.music="music",e.video="video",e.zip="zip",e.pdf="pdf",e.folder="folder",e.white="white"}(l||(l={})),function(e){e.AutoRename="AutoRename",e.Overwrite="Overwrite"}(s||(s={}))},98022:function(e,n,t){"use strict";var r;t.d(n,{hP:function(){return o},YV:function(){return l},gy:function(){return u},M8:function(){return c},zI:function(){return s}}),function(e){e.USER_ACCESS_TOKEN="access_token",e.USER_REFRESH_TOKEN="refresh_token"}(r||(r={}));var i=t(49704),a=t.n(i),o=function(){var e=localStorage.getItem(r.USER_ACCESS_TOKEN);if(!e)return null;var n=a().decode(e).exp;return Date.now()/1e3>n?(localStorage.removeItem(r.USER_ACCESS_TOKEN),null):e},c=function(e){localStorage.setItem(r.USER_ACCESS_TOKEN,e)},l=function(){var e=localStorage.getItem(r.USER_REFRESH_TOKEN);if(!e)return null;var n=a().decode(e).exp;return Date.now()/1e3>n?(localStorage.removeItem(r.USER_REFRESH_TOKEN),null):e},s=function(e){localStorage.setItem(r.USER_REFRESH_TOKEN,e)},u=function(){localStorage.removeItem(r.USER_ACCESS_TOKEN),localStorage.removeItem(r.USER_REFRESH_TOKEN)}},21999:function(e,n,t){"use strict";t.d(n,{x:function(){return c}});var r=t(9669),i=t.n(r),a=t(28662),o=t(98022),c=i().create({baseURL:"".concat("http://47.106.110.246:8080/api"),timeout:6e4});c.interceptors.request.use((function(e){var n=(0,o.hP)();return n&&(e.headers.Authorization="Bearer ".concat(n)),e}),(function(e){throw new Error(e.toString())})),(0,a.ZP)(c,{retries:3,retryCondition:function(e){var n;return"TokenExpired"===(null===(n=e.response)||void 0===n?void 0:n.data.code)}});var l=i().create({baseURL:"".concat("http://47.106.110.246:8080/api"),timeout:6e4});c.interceptors.response.use((function(e){return e}),(function(e){return"TokenExpired"===e.response.data.code&&l.post("auth/tokenRefresh",{refreshToken:(0,o.YV)()}).then((function(e){(0,o.M8)(e.data.accessToken)})).catch((function(){location.replace("/login")})),e}))},89391:function(e){e.exports={"modal-body":"avatar-edit-modal_modal-body__3LrEV","edit-section":"avatar-edit-modal_edit-section__2_A_3","preview-section":"avatar-edit-modal_preview-section__qxfTO",actions:"avatar-edit-modal_actions__LWKVg","scale-action":"avatar-edit-modal_scale-action__6TgQd",slider:"avatar-edit-modal_slider__BTii_",icon:"avatar-edit-modal_icon__5WHp9","upload-button":"avatar-edit-modal_upload-button__qp6pq"}},86801:function(e){e.exports={active:"breadcrumb_active__gGXqi",ellipsis:"breadcrumb_ellipsis__VjW7j"}},51743:function(e){e.exports={"content-container":"content-section_content-container__Ml6_D","view-container":"content-section_view-container__zVJXu",bg:"content-section_bg__cBKwe","upload-tip":"content-section_upload-tip__vLhM5",hidden:"content-section_hidden__ptiJx","forbidden-children-pointer-events":"content-section_forbidden-children-pointer-events__C0wpm"}},83162:function(e){e.exports={"modal-body":"detail-file-modal_modal-body__EdJ84","file-icon":"detail-file-modal_file-icon__QjXfd","detail-group":"detail-file-modal_detail-group__Pxc60","group-name":"detail-file-modal_group-name__q_l8m","group-item":"detail-file-modal_group-item__u3T7k",title:"detail-file-modal_title__47yEG",desc:"detail-file-modal_desc__k11sx"}},88811:function(e){e.exports={"modal-body":"file-move-modal_modal-body__eRgJ1","file-list":"file-move-modal_file-list__CogKh"}},85951:function(e){e.exports={"modal-body":"file-rename-modal_modal-body__DbgJA","file-icon":"file-rename-modal_file-icon__wK6EL"}},65837:function(e){e.exports={"modal-body":"file-search-modal_modal-body__3Rdjg","search-result":"file-search-modal_search-result__zYP7n",empty:"file-search-modal_empty__84YI5"}},19844:function(e){e.exports={"header-line-one":"header_header-line-one__Uq5Sn",path:"header_path__z_3xI",action:"header_action__Ui6iM","search-icon":"header_search-icon__x62Df","upload-menu":"header_upload-menu__gJfXD","upload-icon":"header_upload-icon__0n2H7","header-line-two":"header_header-line-two__8UrVS","list-sum":"header_list-sum__ve6Bm"}},87919:function(e){e.exports={"sort-container":"list-sort_sort-container__ND_RQ","order-icon":"list-sort_order-icon__z522J"}},92853:function(e){e.exports={icon:"list-sum_icon__qZGPu"}},70054:function(e){e.exports={icon:"view-switch-button_icon__mhWaS"}},86674:function(e){e.exports={logo:"logo_logo__Oibcg"}},82898:function(e){e.exports={"modal-body":"new-folder-modal_modal-body__0GKYJ","file-icon":"new-folder-modal_file-icon__s_qwP"}},73294:function(e){e.exports={"modal-body":"password-edit-modal_modal-body__qLTU2","input-item":"password-edit-modal_input-item__bxxMM",input:"password-edit-modal_input__Jv6MN"}},2520:function(e){e.exports={bg:"previewer-modal_bg__PpSa3","previewer-modal":"previewer-modal_previewer-modal__o9K5V",header:"previewer-modal_header__hUnKa",title:"previewer-modal_title__24m5P","close-icon":"previewer-modal_close-icon__BBbjN",divider:"previewer-modal_divider__2Kyf_",content:"previewer-modal_content__RDrNA","text-preview":"previewer-modal_text-preview__Hh10a","markdown-body":"previewer-modal_markdown-body__RaLSC","image-preview":"previewer-modal_image-preview__ERDbx","music-preview":"previewer-modal_music-preview__0pr9o",cover:"previewer-modal_cover__K7if7","video-preview":"previewer-modal_video-preview__D0k28","other-preview":"previewer-modal_other-preview__BlI3s",originalname:"previewer-modal_originalname__uegz8"}},20190:function(e){e.exports={"path-container":"same-name-file-modal_path-container__BqAee"}},69368:function(e){e.exports={"progress-container":"capacity_progress-container__J94s8",text:"capacity_text__9VmAF"}},3206:function(e){e.exports={"sidebar-container":"sidebar_sidebar-container__5JYtl","top-container":"sidebar_top-container__baG8F","download-button":"sidebar_download-button__KddXf","nav-container":"sidebar_nav-container__9G9DS",divider:"sidebar_divider__1BY5P","bottom-container":"sidebar_bottom-container__lSczK","user-info":"sidebar_user-info__iBxNw"}},20809:function(e){e.exports={"menu-container":"nav-menu_menu-container__t_7xl",icon:"nav-menu_icon___BTLK","item-active":"nav-menu_item-active__sBwH6"}},33189:function(e){e.exports={icon:"menu-item-icon_icon___toIF"}},76484:function(e){e.exports={icon:"setting-menu_icon__V63kq"}},81074:function(e){e.exports={icon:"upload-menu_icon__pALNk","menu-item":"upload-menu_menu-item__EwM6U"}},57459:function(e){e.exports={"avatar-container":"avatar_avatar-container__J1WL9"}},50519:function(e){e.exports={"modal-body":"user-info-edit-modal_modal-body__EgHp4","group-item":"user-info-edit-modal_group-item__hVHtp",input:"user-info-edit-modal_input__ziThk","right-section":"user-info-edit-modal_right-section__sZJVK","avatar-container":"user-info-edit-modal_avatar-container__d1XnB",avatar:"user-info-edit-modal_avatar__t4Khu","avatar-mask":"user-info-edit-modal_avatar-mask__IgbY2"}},32624:function(e){e.exports={"card-container":"file-card_card-container__l5Hvn","select-button":"file-card_select-button__QHzm9","button-show":"file-card_button-show___CQHC","button-hidden":"file-card_button-hidden__S7GZa",card:"file-card_card__Ilxpb",filename:"file-card_filename__G0IPz","update-time":"file-card_update-time__fYCMW"}},38200:function(e){e.exports={"grid-container":"card-view_grid-container__is5_a"}},92040:function(e){e.exports={"file-icon-container":"file-icon_file-icon-container__QwYxP"}},87339:function(e){e.exports={"tr-container":"file-list-item_tr-container__b8i5j","select-button":"file-list-item_select-button__W9_uT","button-show":"file-list-item_button-show___0AUC","button-hidden":"file-list-item_button-hidden__aPdRB","file-container":"file-list-item_file-container__n97dQ","icon-filename-container":"file-list-item_icon-filename-container__FuO8R",filename:"file-list-item_filename__0EA8z",hignlight:"file-list-item_hignlight__PqG_6","sort-by-time":"file-list-item_sort-by-time__Mp2Fj",size:"file-list-item_size__bJwPM","not-click-allowed":"file-list-item_not-click-allowed__ycCPm"}},76026:function(e){e.exports={"table-container":"table-view_table-container__TBrPu",divider:"table-view_divider__Wluth",thead:"table-view_thead__oUUsQ",time:"table-view_time__f4FiU","list-container":"table-view_list-container__bVf30","icon-filename-container":"table-view_icon-filename-container__vPs81",filename:"table-view_filename__nEu17","sort-by-time":"table-view_sort-by-time__WtYhe",size:"table-view_size__wUCta"}},1634:function(e){e.exports={"main-layout-container":"main-layout_main-layout-container__urT7P"}}}]);